[0m21:00:12.368519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9de90>]}


============================== 21:00:12.372024 | fb72f3ab-0623-4851-910a-272438489669 ==============================
[0m21:00:12.372024 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:00:12.373020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs'}
[0m21:00:12.503689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a9dad0>]}
[0m21:00:12.524174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac26d0>]}
[0m21:00:12.524916 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:00:12.538084 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:00:12.538852 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:00:12.539421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b7d790>]}
[0m21:00:13.482232 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m21:00:13.498259 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m21:00:13.502388 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m21:00:13.506676 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m21:00:13.613418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc0290>]}
[0m21:00:13.622694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111da8710>]}
[0m21:00:13.623335 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:00:13.623872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb72f3ab-0623-4851-910a-272438489669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d48ed0>]}
[0m21:00:13.625676 [info ] [MainThread]: 
[0m21:00:13.626696 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:13.628214 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m21:00:13.646542 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m21:00:13.647222 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m21:00:13.647702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:13.655057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:13.655515 [debug] [MainThread]: Connection 'list_footprint' was properly closed.
[0m21:00:13.655914 [info ] [MainThread]: 
[0m21:00:13.656445 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m21:00:13.657088 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/../../data/footprint.duckdb": No such file or directory
[0m21:00:13.657849 [debug] [MainThread]: Command `dbt run` failed at 21:00:13.657686 after 1.31 seconds
[0m21:00:13.658313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f90d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ac2250>]}
[0m21:00:13.658785 [debug] [MainThread]: Flushing usage events
[0m21:00:49.691326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803ef10>]}


============================== 21:00:49.694885 | 0f4ca692-2466-4113-99fb-4af025b45c86 ==============================
[0m21:00:49.694885 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:00:49.695799 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True'}
[0m21:00:49.825572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a7e90>]}
[0m21:00:49.844722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805e090>]}
[0m21:00:49.845398 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:00:49.858236 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:00:49.868138 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:00:49.868947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108237290>]}
[0m21:00:50.818978 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m21:00:50.835023 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m21:00:50.839212 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m21:00:50.843404 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m21:00:50.942261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d8050>]}
[0m21:00:50.949783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081db7d0>]}
[0m21:00:50.950302 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:00:50.950761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f4ca692-2466-4113-99fb-4af025b45c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c7b10>]}
[0m21:00:50.952549 [info ] [MainThread]: 
[0m21:00:50.953415 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:00:50.954712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m21:00:50.973224 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m21:00:50.973802 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m21:00:50.974239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:50.981684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:50.982198 [debug] [MainThread]: Connection 'list_footprint' was properly closed.
[0m21:00:50.982647 [info ] [MainThread]: 
[0m21:00:50.983208 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m21:00:50.983897 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/../data/footprint.duckdb": No such file or directory
[0m21:00:50.985322 [debug] [MainThread]: Command `dbt run` failed at 21:00:50.984824 after 1.32 seconds
[0m21:00:50.986152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108053250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d8450>]}
[0m21:00:50.986724 [debug] [MainThread]: Flushing usage events
[0m21:04:12.216240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110155b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110155fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110155dd0>]}


============================== 21:04:12.219794 | bd99866a-fe6a-4ed0-be2b-204a51057cbe ==============================
[0m21:04:12.219794 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:04:12.220710 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'target_path': 'None'}
[0m21:04:12.349932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110171e10>]}
[0m21:04:12.369111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110189dd0>]}
[0m21:04:12.369799 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:04:12.382406 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:04:12.392602 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:04:12.393192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027ba10>]}
[0m21:04:13.349982 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m21:04:13.366123 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m21:04:13.370266 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m21:04:13.374437 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m21:04:13.476754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110375f10>]}
[0m21:04:13.484128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102eb390>]}
[0m21:04:13.484656 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:04:13.485111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102eb390>]}
[0m21:04:13.486695 [info ] [MainThread]: 
[0m21:04:13.487591 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:04:13.488815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m21:04:13.503569 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m21:04:13.503974 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m21:04:13.504331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:13.518089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.519634 [debug] [ThreadPool]: On list_footprint: Close
[0m21:04:13.521986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m21:04:13.522852 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m21:04:13.530957 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:04:13.531492 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m21:04:13.531909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:13.542391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.542950 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:04:13.543367 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m21:04:13.543971 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.545098 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m21:04:13.545522 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:04:13.545919 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m21:04:13.546454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.546872 [debug] [ThreadPool]: On create_footprint_main: Close
[0m21:04:13.550383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m21:04:13.559025 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:04:13.559472 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m21:04:13.559869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:13.569543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.569976 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:04:13.570357 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m21:04:13.580279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:13.581688 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m21:04:13.584008 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m21:04:13.584555 [debug] [ThreadPool]: On list_footprint_main: Close
[0m21:04:13.587400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110404150>]}
[0m21:04:13.587986 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:13.588409 [debug] [MainThread]: On master: BEGIN
[0m21:04:13.588811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:13.597993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:13.598490 [debug] [MainThread]: On master: COMMIT
[0m21:04:13.598906 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:13.599311 [debug] [MainThread]: On master: COMMIT
[0m21:04:13.599850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:13.600261 [debug] [MainThread]: On master: Close
[0m21:04:13.602145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:13.602642 [info ] [MainThread]: 
[0m21:04:13.605127 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m21:04:13.605891 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:04:13.606916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m21:04:13.607693 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m21:04:13.619636 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.621519 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 21:04:13.608049 => 21:04:13.621083
[0m21:04:13.622128 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m21:04:13.673932 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.675146 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.675603 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m21:04:13.676029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:13.684826 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.685341 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.685912 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:04:13.686959 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.694926 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.695435 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:04:13.696132 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.720219 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m21:04:13.720757 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.721207 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m21:04:13.722462 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.729498 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:04:13.729983 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:04:13.730640 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.732427 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 21:04:13.622527 => 21:04:13.732078
[0m21:04:13.732920 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m21:04:13.736426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d4990>]}
[0m21:04:13.737161 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.13s]
[0m21:04:13.738049 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m21:04:13.738641 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m21:04:13.739195 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m21:04:13.740024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m21:04:13.740468 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m21:04:13.742739 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m21:04:13.743993 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 21:04:13.740773 => 21:04:13.743657
[0m21:04:13.744484 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m21:04:13.776945 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m21:04:13.778067 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:04:13.778606 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m21:04:13.779117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:13.788971 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.789591 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:04:13.790149 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m21:04:13.791140 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.795702 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:04:13.796317 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m21:04:13.797208 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.799541 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m21:04:13.800115 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:04:13.800645 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m21:04:13.801852 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.805899 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:04:13.806495 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m21:04:13.807303 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.809435 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 21:04:13.744798 => 21:04:13.809029
[0m21:04:13.810039 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m21:04:13.813634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055cdd0>]}
[0m21:04:13.814559 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.07s]
[0m21:04:13.815599 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m21:04:13.816305 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m21:04:13.816961 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:04:13.818219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m21:04:13.818757 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m21:04:13.822806 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.823897 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 21:04:13.819110 => 21:04:13.823544
[0m21:04:13.824499 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m21:04:13.830367 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.831361 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.832097 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m21:04:13.832757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:13.843951 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.844598 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.845152 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:04:13.845982 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.850466 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.851019 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:04:13.851765 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.854215 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m21:04:13.855505 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.856287 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m21:04:13.857724 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.861984 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:04:13.862740 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:04:13.863576 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.865800 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 21:04:13.824861 => 21:04:13.865450
[0m21:04:13.866426 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m21:04:13.870336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11055ba10>]}
[0m21:04:13.871258 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m21:04:13.872330 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m21:04:13.873082 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m21:04:13.873756 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m21:04:13.874841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m21:04:13.875543 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m21:04:13.880475 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m21:04:13.881946 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 21:04:13.875971 => 21:04:13.881574
[0m21:04:13.882577 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m21:04:13.888536 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m21:04:13.889619 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:04:13.890172 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m21:04:13.890697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:13.900943 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.901615 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:04:13.902193 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m21:04:13.909601 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.915647 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:04:13.916419 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m21:04:13.917291 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.919849 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m21:04:13.920427 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:04:13.920962 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m21:04:13.922894 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.926769 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:04:13.927324 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m21:04:13.928061 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:13.930030 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 21:04:13.882947 => 21:04:13.929708
[0m21:04:13.930593 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m21:04:13.939689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd99866a-fe6a-4ed0-be2b-204a51057cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d5e10>]}
[0m21:04:13.940592 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.07s]
[0m21:04:13.941614 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m21:04:14.021793 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:14.022422 [debug] [MainThread]: On master: BEGIN
[0m21:04:14.022904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:14.034053 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:14.034595 [debug] [MainThread]: On master: COMMIT
[0m21:04:14.035042 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:14.035475 [debug] [MainThread]: On master: COMMIT
[0m21:04:14.036046 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:14.036506 [debug] [MainThread]: On master: Close
[0m21:04:14.038533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:14.039017 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m21:04:14.039498 [info ] [MainThread]: 
[0m21:04:14.040075 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m21:04:14.042082 [debug] [MainThread]: Command end result
[0m21:04:14.050619 [info ] [MainThread]: 
[0m21:04:14.051442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:14.052095 [info ] [MainThread]: 
[0m21:04:14.053396 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:04:14.054465 [debug] [MainThread]: Command `dbt run` succeeded at 21:04:14.054269 after 1.86 seconds
[0m21:04:14.054997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110155b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110155fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110171f50>]}
[0m21:04:14.055602 [debug] [MainThread]: Flushing usage events
[0m21:04:32.202801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da55b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da55e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da55f10>]}


============================== 21:04:32.206361 | a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6 ==============================
[0m21:04:32.206361 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:04:32.207283 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m21:04:32.341125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dabee90>]}
[0m21:04:32.360592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da89590>]}
[0m21:04:32.361293 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:04:32.376168 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:04:32.408602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:32.409051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:32.416370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daca1d0>]}
[0m21:04:32.423605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd9910>]}
[0m21:04:32.424122 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:04:32.424617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd9910>]}
[0m21:04:32.426307 [info ] [MainThread]: 
[0m21:04:32.427160 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:04:32.428457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint_main'
[0m21:04:32.489589 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:04:32.490195 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m21:04:32.490675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:32.506649 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:32.507226 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:04:32.507724 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m21:04:32.521050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:04:32.523024 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m21:04:32.523777 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m21:04:32.524204 [debug] [ThreadPool]: On list_footprint_main: Close
[0m21:04:32.528424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a28ed4-8f1a-44cf-bee8-ac5208fac1a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daef2d0>]}
[0m21:04:32.529029 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:32.529466 [debug] [MainThread]: On master: BEGIN
[0m21:04:32.529875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:32.540701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:32.541223 [debug] [MainThread]: On master: COMMIT
[0m21:04:32.541667 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:32.542088 [debug] [MainThread]: On master: COMMIT
[0m21:04:32.542639 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:32.543090 [debug] [MainThread]: On master: Close
[0m21:04:32.545060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:32.545621 [info ] [MainThread]: 
[0m21:04:32.547759 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:04:32.548368 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:04:32.549358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m21:04:32.549897 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:04:32.576518 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:04:32.577888 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 21:04:32.550264 => 21:04:32.577497
[0m21:04:32.578480 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:04:32.598874 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:04:32.599832 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:04:32.600307 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m21:04:32.600772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:32.609274 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.609788 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:04:32.610371 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m21:04:32.611585 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.614363 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 21:04:32.578845 => 21:04:32.614069
[0m21:04:32.614857 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m21:04:32.615375 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:04:32.615815 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:04:32.617881 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
[0m21:04:32.618782 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:04:32.619396 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:04:32.619884 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m21:04:32.620711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m21:04:32.621169 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:04:32.626384 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:04:32.627309 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 21:04:32.621480 => 21:04:32.627008
[0m21:04:32.627782 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:04:32.631284 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:04:32.632453 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:04:32.633016 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m21:04:32.633502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:32.643825 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.644449 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:04:32.644984 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m21:04:32.646203 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.648747 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 21:04:32.628085 => 21:04:32.648090
[0m21:04:32.649558 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m21:04:32.650194 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m21:04:32.650797 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m21:04:32.653316 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m21:04:32.654372 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:04:32.655071 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:04:32.655639 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:04:32.656687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m21:04:32.657228 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:04:32.666390 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:04:32.667407 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 21:04:32.657585 => 21:04:32.667075
[0m21:04:32.667938 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:04:32.671281 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:04:32.673287 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:04:32.673822 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m21:04:32.674325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:32.685363 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.686027 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:04:32.686578 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:04:32.688065 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.690115 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 21:04:32.668280 => 21:04:32.689779
[0m21:04:32.690682 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m21:04:32.691282 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m21:04:32.691783 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:04:32.694080 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:04:32.695126 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:04:32.695820 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:04:32.696378 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m21:04:32.697800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321, now test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m21:04:32.698854 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:04:32.706203 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:04:32.707434 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 21:04:32.699275 => 21:04:32.707058
[0m21:04:32.708036 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:04:32.711597 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:04:32.712547 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:04:32.713107 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m21:04:32.713642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:04:32.724364 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.725430 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:04:32.726197 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:04:32.728767 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:04:32.731181 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 21:04:32.708429 => 21:04:32.730804
[0m21:04:32.731808 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m21:04:32.732453 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m21:04:32.733001 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m21:04:32.735481 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
[0m21:04:32.736614 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:04:32.757378 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:32.758129 [debug] [MainThread]: On master: BEGIN
[0m21:04:32.758728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:04:32.770259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:32.770848 [debug] [MainThread]: On master: COMMIT
[0m21:04:32.771318 [debug] [MainThread]: Using duckdb connection "master"
[0m21:04:32.771759 [debug] [MainThread]: On master: COMMIT
[0m21:04:32.772332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:04:32.772790 [debug] [MainThread]: On master: Close
[0m21:04:32.774918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:32.775335 [debug] [MainThread]: Connection 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m21:04:32.775784 [info ] [MainThread]: 
[0m21:04:32.776370 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m21:04:32.778957 [debug] [MainThread]: Command end result
[0m21:04:32.789120 [info ] [MainThread]: 
[0m21:04:32.789851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:04:32.790563 [info ] [MainThread]: 
[0m21:04:32.791306 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m21:04:32.791894 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:04:32.792451 [info ] [MainThread]: 
[0m21:04:32.793004 [info ] [MainThread]:   compiled Code at target/compiled/footprint_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m21:04:32.793574 [info ] [MainThread]: 
[0m21:04:32.794223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:04:32.795101 [debug] [MainThread]: Command `dbt test` failed at 21:04:32.794918 after 0.62 seconds
[0m21:04:32.795658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db27110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddbf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db7add0>]}
[0m21:04:32.796218 [debug] [MainThread]: Flushing usage events
[0m21:40:38.521124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381dfd0>]}


============================== 21:40:38.526899 | c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd ==============================
[0m21:40:38.526899 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:40:38.528024 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs'}
[0m21:40:38.685372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113886e90>]}
[0m21:40:38.704564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383d710>]}
[0m21:40:38.706688 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:40:38.726984 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:40:38.738706 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:40:38.739393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f6b10>]}
[0m21:40:39.721862 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m21:40:39.743216 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m21:40:39.747831 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m21:40:39.752079 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m21:40:39.850698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139bbe50>]}
[0m21:40:39.858153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3df50>]}
[0m21:40:39.858713 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:40:39.859206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a3dfd0>]}
[0m21:40:39.860757 [info ] [MainThread]: 
[0m21:40:39.861584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:40:39.862795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m21:40:39.877528 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m21:40:39.877936 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m21:40:39.878294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:39.895748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.897933 [debug] [ThreadPool]: On list_footprint: Close
[0m21:40:39.900606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m21:40:39.901561 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m21:40:39.908879 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:40:39.909315 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m21:40:39.909705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:39.920701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.921253 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:40:39.921675 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m21:40:39.922329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.923665 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m21:40:39.924320 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m21:40:39.924845 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m21:40:39.925728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.926254 [debug] [ThreadPool]: On create_footprint_main: Close
[0m21:40:39.929689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m21:40:39.938433 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:40:39.938889 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m21:40:39.939294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:39.949338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.949829 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:40:39.950261 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m21:40:39.966608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:39.968263 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m21:40:39.972535 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m21:40:39.973096 [debug] [ThreadPool]: On list_footprint_main: Close
[0m21:40:39.975967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b6d410>]}
[0m21:40:39.976593 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:39.977026 [debug] [MainThread]: On master: BEGIN
[0m21:40:39.977430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:39.987144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:39.987654 [debug] [MainThread]: On master: COMMIT
[0m21:40:39.988086 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:39.988506 [debug] [MainThread]: On master: COMMIT
[0m21:40:39.989053 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:39.989492 [debug] [MainThread]: On master: Close
[0m21:40:39.991542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:39.992102 [info ] [MainThread]: 
[0m21:40:39.994736 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m21:40:39.995532 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:40:39.996534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m21:40:39.997332 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m21:40:40.010249 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.011456 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 21:40:39.997700 => 21:40:40.011058
[0m21:40:40.012046 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m21:40:40.067301 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.068188 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.068658 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m21:40:40.069100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:40.077921 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.078453 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.078985 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:40:40.084314 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.093796 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.094371 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:40:40.095972 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.123348 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m21:40:40.123865 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.124315 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m21:40:40.127053 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.138745 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m21:40:40.139368 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m21:40:40.140226 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.142393 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 21:40:40.012432 => 21:40:40.142059
[0m21:40:40.142980 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m21:40:40.148071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4e690>]}
[0m21:40:40.148978 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.15s]
[0m21:40:40.150024 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m21:40:40.150730 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m21:40:40.151389 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m21:40:40.152578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m21:40:40.153129 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m21:40:40.155807 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m21:40:40.156878 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 21:40:40.153493 => 21:40:40.156516
[0m21:40:40.157444 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m21:40:40.191013 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m21:40:40.192073 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:40:40.192624 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m21:40:40.193154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:40.205221 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.206023 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:40:40.206757 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m21:40:40.207802 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.212455 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:40:40.213019 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m21:40:40.213781 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.215968 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m21:40:40.216563 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:40:40.217088 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m21:40:40.218349 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.222113 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m21:40:40.222667 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m21:40:40.223387 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.225325 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 21:40:40.157802 => 21:40:40.224996
[0m21:40:40.225898 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m21:40:40.229914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bc6fd0>]}
[0m21:40:40.230826 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.08s]
[0m21:40:40.231869 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m21:40:40.232574 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m21:40:40.233241 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:40:40.234353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m21:40:40.234888 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m21:40:40.238728 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.239704 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 21:40:40.235246 => 21:40:40.239371
[0m21:40:40.240239 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m21:40:40.245684 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.246735 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.247276 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m21:40:40.247784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:40.259015 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.259716 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.260301 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:40:40.261190 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.265852 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.266467 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:40:40.267270 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.269449 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m21:40:40.270068 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.270601 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m21:40:40.271827 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.275594 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m21:40:40.276239 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m21:40:40.276977 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.278850 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 21:40:40.240580 => 21:40:40.278532
[0m21:40:40.279408 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m21:40:40.283772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c31190>]}
[0m21:40:40.284941 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m21:40:40.286557 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m21:40:40.287497 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m21:40:40.288365 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m21:40:40.289450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m21:40:40.290009 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m21:40:40.294833 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m21:40:40.296569 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 21:40:40.290392 => 21:40:40.296161
[0m21:40:40.297186 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m21:40:40.304393 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m21:40:40.305508 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:40:40.306091 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m21:40:40.306646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:40.317284 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.317983 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:40:40.318572 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m21:40:40.329880 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.336701 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:40:40.337686 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m21:40:40.338671 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.341584 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m21:40:40.342588 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:40:40.343446 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m21:40:40.345415 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.350402 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m21:40:40.351280 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m21:40:40.352192 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:40.354423 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 21:40:40.297627 => 21:40:40.354073
[0m21:40:40.355050 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m21:40:40.365444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1c244f7-8a7e-440b-b14a-eb78dbd1d0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cbc190>]}
[0m21:40:40.366370 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.08s]
[0m21:40:40.367436 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m21:40:40.410185 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:40.411099 [debug] [MainThread]: On master: BEGIN
[0m21:40:40.411849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:40.423922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:40.424457 [debug] [MainThread]: On master: COMMIT
[0m21:40:40.424968 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:40.425439 [debug] [MainThread]: On master: COMMIT
[0m21:40:40.426030 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:40.426493 [debug] [MainThread]: On master: Close
[0m21:40:40.429257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:40.429838 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m21:40:40.430386 [info ] [MainThread]: 
[0m21:40:40.431024 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m21:40:40.433522 [debug] [MainThread]: Command end result
[0m21:40:40.443721 [info ] [MainThread]: 
[0m21:40:40.444525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:40.445110 [info ] [MainThread]: 
[0m21:40:40.445763 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:40:40.446763 [debug] [MainThread]: Command `dbt run` succeeded at 21:40:40.446529 after 1.97 seconds
[0m21:40:40.447711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383d290>]}
[0m21:40:40.448822 [debug] [MainThread]: Flushing usage events
[0m21:40:46.804065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c6f50>]}


============================== 21:40:46.807593 | c90fab5f-6787-437b-b926-dd5615b5c70f ==============================
[0m21:40:46.807593 [info ] [MainThread]: Running with dbt=1.5.11
[0m21:40:46.808493 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'warn_error': 'None'}
[0m21:40:46.940962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a2ff90>]}
[0m21:40:46.960180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a9d810>]}
[0m21:40:46.960855 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m21:40:46.973452 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m21:40:47.005758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:47.006231 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:47.014520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3c310>]}
[0m21:40:47.025149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4a710>]}
[0m21:40:47.025887 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:40:47.026470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4a710>]}
[0m21:40:47.028956 [info ] [MainThread]: 
[0m21:40:47.030512 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:40:47.032390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint_main'
[0m21:40:47.103459 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:40:47.104066 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m21:40:47.104540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:47.120667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:47.121230 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m21:40:47.121714 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m21:40:47.135144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m21:40:47.137142 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m21:40:47.137908 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m21:40:47.138353 [debug] [ThreadPool]: On list_footprint_main: Close
[0m21:40:47.142555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90fab5f-6787-437b-b926-dd5615b5c70f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a579d0>]}
[0m21:40:47.143227 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:47.143685 [debug] [MainThread]: On master: BEGIN
[0m21:40:47.144117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:47.154975 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:47.155486 [debug] [MainThread]: On master: COMMIT
[0m21:40:47.155913 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:47.156324 [debug] [MainThread]: On master: COMMIT
[0m21:40:47.156866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:47.157309 [debug] [MainThread]: On master: Close
[0m21:40:47.159368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:47.159920 [info ] [MainThread]: 
[0m21:40:47.162019 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:40:47.162626 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:40:47.163634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m21:40:47.164243 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:40:47.190910 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:40:47.192648 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 21:40:47.164706 => 21:40:47.192062
[0m21:40:47.193347 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:40:47.214936 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:40:47.215964 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:40:47.216560 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m21:40:47.217075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:47.226973 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.227565 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:40:47.228093 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m21:40:47.231058 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.235339 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 21:40:47.193718 => 21:40:47.234935
[0m21:40:47.235985 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m21:40:47.236601 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:40:47.237125 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:40:47.239466 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
[0m21:40:47.240532 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:40:47.241224 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:40:47.241784 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m21:40:47.242813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m21:40:47.243357 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:40:47.249307 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:40:47.250284 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 21:40:47.243701 => 21:40:47.249957
[0m21:40:47.250809 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:40:47.254063 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:40:47.254996 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:40:47.255551 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m21:40:47.256056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:47.267752 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.268439 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m21:40:47.268991 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m21:40:47.270305 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.272387 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 21:40:47.251147 => 21:40:47.272044
[0m21:40:47.272955 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m21:40:47.273563 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m21:40:47.274079 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m21:40:47.276523 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m21:40:47.277659 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m21:40:47.278360 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:40:47.278922 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:40:47.279976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m21:40:47.280500 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:40:47.290566 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:40:47.292106 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 21:40:47.280850 => 21:40:47.291676
[0m21:40:47.292725 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:40:47.296514 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:40:47.300148 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:40:47.300797 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m21:40:47.301366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:47.312786 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.313453 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m21:40:47.314025 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:40:47.317824 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.319991 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 21:40:47.293078 => 21:40:47.319634
[0m21:40:47.320660 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m21:40:47.321299 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m21:40:47.321836 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:40:47.324289 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m21:40:47.325330 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m21:40:47.326025 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:40:47.326846 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m21:40:47.327980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321, now test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m21:40:47.328520 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:40:47.335504 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:40:47.336733 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 21:40:47.328874 => 21:40:47.336342
[0m21:40:47.337442 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:40:47.341662 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:40:47.342723 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:40:47.343293 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m21:40:47.343832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:40:47.355132 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.355822 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:40:47.356441 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:40:47.357998 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m21:40:47.360278 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 21:40:47.337948 => 21:40:47.359917
[0m21:40:47.360878 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m21:40:47.361522 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m21:40:47.362063 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m21:40:47.364517 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
[0m21:40:47.365582 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m21:40:47.371823 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:47.372292 [debug] [MainThread]: On master: BEGIN
[0m21:40:47.372695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:40:47.383609 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:47.384195 [debug] [MainThread]: On master: COMMIT
[0m21:40:47.384626 [debug] [MainThread]: Using duckdb connection "master"
[0m21:40:47.385043 [debug] [MainThread]: On master: COMMIT
[0m21:40:47.385594 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m21:40:47.386038 [debug] [MainThread]: On master: Close
[0m21:40:47.388747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:47.389331 [debug] [MainThread]: Connection 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m21:40:47.389822 [info ] [MainThread]: 
[0m21:40:47.390417 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:40:47.392455 [debug] [MainThread]: Command end result
[0m21:40:47.403882 [info ] [MainThread]: 
[0m21:40:47.404646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:40:47.405209 [info ] [MainThread]: 
[0m21:40:47.405786 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m21:40:47.406332 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:40:47.406876 [info ] [MainThread]: 
[0m21:40:47.407415 [info ] [MainThread]:   compiled Code at target/compiled/footprint_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m21:40:47.407970 [info ] [MainThread]: 
[0m21:40:47.408614 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:40:47.409433 [debug] [MainThread]: Command `dbt test` failed at 21:40:47.409262 after 0.63 seconds
[0m21:40:47.409958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a35f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c750>]}
[0m21:40:47.410528 [debug] [MainThread]: Flushing usage events
[0m01:21:36.125217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6f50>]}


============================== 01:21:36.130627 | d7eacfec-4866-403a-9e79-10860fa9c518 ==============================
[0m01:21:36.130627 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:21:36.131754 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'introspect': 'True', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default'}
[0m01:21:36.287668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862fe90>]}
[0m01:21:36.307892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10869d650>]}
[0m01:21:36.309246 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:21:36.325416 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:21:36.405521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:36.406100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:36.416234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863b250>]}
[0m01:21:36.428961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874c750>]}
[0m01:21:36.429777 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:21:36.430409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874c750>]}
[0m01:21:36.432657 [info ] [MainThread]: 
[0m01:21:36.433824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:21:36.435449 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:21:36.518704 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:21:36.519330 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:21:36.519832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:36.540962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.543586 [debug] [ThreadPool]: On list_footprint: Close
[0m01:21:36.546584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m01:21:36.547615 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m01:21:36.555161 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:21:36.555670 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m01:21:36.556202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:36.566547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.567064 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:21:36.567513 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m01:21:36.568207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.569399 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:21:36.569840 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:21:36.570261 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:21:36.570808 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.571247 [debug] [ThreadPool]: On create_footprint_main: Close
[0m01:21:36.574660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m01:21:36.583436 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:21:36.583899 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m01:21:36.584310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:21:36.594028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.594541 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:21:36.594996 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m01:21:36.612890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:36.615282 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m01:21:36.617321 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m01:21:36.617873 [debug] [ThreadPool]: On list_footprint_main: Close
[0m01:21:36.620767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108661dd0>]}
[0m01:21:36.621362 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:36.621796 [debug] [MainThread]: On master: BEGIN
[0m01:21:36.622204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:36.631730 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:36.632256 [debug] [MainThread]: On master: COMMIT
[0m01:21:36.632692 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:36.633109 [debug] [MainThread]: On master: COMMIT
[0m01:21:36.633656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:36.634096 [debug] [MainThread]: On master: Close
[0m01:21:36.636066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:36.636624 [info ] [MainThread]: 
[0m01:21:36.639294 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m01:21:36.640090 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m01:21:36.641312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m01:21:36.641865 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m01:21:36.654807 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.656771 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 01:21:36.642237 => 01:21:36.656372
[0m01:21:36.657466 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m01:21:36.711502 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.713502 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.714211 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m01:21:36.714743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:36.724752 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.725337 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.725883 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m01:21:36.727680 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.736722 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.737406 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:21:36.738249 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.763109 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:21:36.763622 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.764064 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:21:36.765265 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.773154 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:21:36.773650 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m01:21:36.774367 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.776206 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 01:21:36.657830 => 01:21:36.775938
[0m01:21:36.776813 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m01:21:36.780762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e9e10>]}
[0m01:21:36.781539 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m01:21:36.782437 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m01:21:36.783050 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m01:21:36.783612 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m01:21:36.784617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m01:21:36.785115 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m01:21:36.787628 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m01:21:36.790019 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 01:21:36.785444 => 01:21:36.789544
[0m01:21:36.790683 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m01:21:36.822028 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m01:21:36.823755 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:21:36.824409 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m01:21:36.824938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:36.837076 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.837735 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:21:36.838299 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m01:21:36.839184 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.843753 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:21:36.844306 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m01:21:36.845066 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.847270 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:21:36.847871 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:21:36.848448 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:21:36.849711 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.853387 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:21:36.853937 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m01:21:36.854657 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.856612 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 01:21:36.791042 => 01:21:36.856281
[0m01:21:36.857185 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m01:21:36.861279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108923050>]}
[0m01:21:36.862200 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.08s]
[0m01:21:36.863230 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m01:21:36.863921 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m01:21:36.864567 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m01:21:36.865508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m01:21:36.866031 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m01:21:36.869984 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.871079 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 01:21:36.866387 => 01:21:36.870736
[0m01:21:36.871624 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m01:21:36.879048 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.880455 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.881059 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m01:21:36.881586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:36.892261 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.892887 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.893438 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m01:21:36.894933 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.900863 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.901630 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:21:36.902998 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.905984 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:21:36.906657 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.907233 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:21:36.908611 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.914011 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:21:36.914627 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m01:21:36.915425 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.917506 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 01:21:36.871977 => 01:21:36.917157
[0m01:21:36.918113 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m01:21:36.922374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d0250>]}
[0m01:21:36.923342 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m01:21:36.924440 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m01:21:36.925177 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m01:21:36.925842 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m01:21:36.926920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m01:21:36.927466 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m01:21:36.931471 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m01:21:36.933338 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 01:21:36.927833 => 01:21:36.932805
[0m01:21:36.934029 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m01:21:36.939883 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m01:21:36.941005 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:21:36.941582 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m01:21:36.942376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:36.954027 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.954692 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:21:36.955265 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m01:21:36.966660 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.972594 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:21:36.973307 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m01:21:36.974203 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.976869 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:21:36.977440 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:21:36.978002 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:21:36.979580 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.983662 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:21:36.984346 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m01:21:36.985121 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:36.987056 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 01:21:36.934401 => 01:21:36.986737
[0m01:21:36.987621 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m01:21:36.994723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7eacfec-4866-403a-9e79-10860fa9c518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fadd0>]}
[0m01:21:36.995677 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.07s]
[0m01:21:36.996752 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m01:21:37.062094 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:37.063014 [debug] [MainThread]: On master: BEGIN
[0m01:21:37.063757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:37.075594 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:37.076152 [debug] [MainThread]: On master: COMMIT
[0m01:21:37.076624 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:37.077079 [debug] [MainThread]: On master: COMMIT
[0m01:21:37.077672 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:37.078148 [debug] [MainThread]: On master: Close
[0m01:21:37.080243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:37.080686 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m01:21:37.081193 [info ] [MainThread]: 
[0m01:21:37.081806 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m01:21:37.083969 [debug] [MainThread]: Command end result
[0m01:21:37.092979 [info ] [MainThread]: 
[0m01:21:37.093654 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:21:37.094394 [info ] [MainThread]: 
[0m01:21:37.095040 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:21:37.096346 [debug] [MainThread]: Command `dbt run` succeeded at 01:21:37.095903 after 1.02 seconds
[0m01:21:37.097710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085db150>]}
[0m01:21:37.098687 [debug] [MainThread]: Flushing usage events
[0m01:21:44.513818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f806b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f806e90>]}


============================== 01:21:44.517330 | 56e155c6-44ac-448a-b3eb-634cf5f108ff ==============================
[0m01:21:44.517330 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:21:44.518239 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'log_format': 'default'}
[0m01:21:44.658142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f86ff10>]}
[0m01:21:44.678691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f83abd0>]}
[0m01:21:44.679452 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:21:44.694196 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:21:44.732382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:21:44.732897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:21:44.741598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f986710>]}
[0m01:21:44.750442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f98ba10>]}
[0m01:21:44.751085 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:21:44.751728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f98b510>]}
[0m01:21:44.753826 [info ] [MainThread]: 
[0m01:21:44.754883 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:21:44.756458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint_main'
[0m01:21:44.833208 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:21:44.833813 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m01:21:44.834390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:21:44.851182 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:44.851890 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:21:44.852399 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m01:21:44.866449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:21:44.868712 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m01:21:44.869607 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m01:21:44.870088 [debug] [ThreadPool]: On list_footprint_main: Close
[0m01:21:44.874511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e155c6-44ac-448a-b3eb-634cf5f108ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f891b10>]}
[0m01:21:44.875232 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:44.875793 [debug] [MainThread]: On master: BEGIN
[0m01:21:44.876281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:21:44.886797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:44.887352 [debug] [MainThread]: On master: COMMIT
[0m01:21:44.887781 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:44.888193 [debug] [MainThread]: On master: COMMIT
[0m01:21:44.888733 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:44.889164 [debug] [MainThread]: On master: Close
[0m01:21:44.891250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:21:44.891812 [info ] [MainThread]: 
[0m01:21:44.894105 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:21:44.894737 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m01:21:44.895741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m01:21:44.896283 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:21:44.928454 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:21:44.929717 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 01:21:44.896648 => 01:21:44.929318
[0m01:21:44.930357 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:21:44.957549 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:21:44.958730 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:21:44.959329 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m01:21:44.959892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:44.971689 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:44.972431 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m01:21:44.973023 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m01:21:44.976395 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:44.980828 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 01:21:44.930756 => 01:21:44.980383
[0m01:21:44.981550 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m01:21:44.982339 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m01:21:44.982983 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m01:21:44.985573 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
[0m01:21:44.986730 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m01:21:44.987497 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m01:21:44.988112 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m01:21:44.989130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m01:21:44.989692 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m01:21:44.997551 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m01:21:45.000780 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 01:21:44.990325 => 01:21:44.999772
[0m01:21:45.001686 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m01:21:45.007411 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m01:21:45.008616 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m01:21:45.009235 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m01:21:45.009794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:45.023525 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.024967 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m01:21:45.025864 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m01:21:45.027319 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.029601 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 01:21:45.002129 => 01:21:45.029223
[0m01:21:45.030334 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m01:21:45.031180 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m01:21:45.031877 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m01:21:45.034564 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
[0m01:21:45.035723 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m01:21:45.036487 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:21:45.037109 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m01:21:45.038184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m01:21:45.039111 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:21:45.051702 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:21:45.052927 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 01:21:45.039842 => 01:21:45.052542
[0m01:21:45.053539 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:21:45.057540 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:21:45.061089 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:21:45.062328 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m01:21:45.062986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:45.074778 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.075484 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m01:21:45.076103 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:21:45.082045 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.084504 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 01:21:45.053921 => 01:21:45.084109
[0m01:21:45.085146 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m01:21:45.085820 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m01:21:45.086407 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m01:21:45.089003 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
[0m01:21:45.090143 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m01:21:45.090902 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m01:21:45.091513 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m01:21:45.092623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321, now test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m01:21:45.093287 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m01:21:45.099435 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:21:45.100517 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 01:21:45.093668 => 01:21:45.100164
[0m01:21:45.101085 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m01:21:45.104876 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:21:45.107273 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:21:45.108221 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m01:21:45.108807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:21:45.119445 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.120115 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m01:21:45.120692 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m01:21:45.122157 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:21:45.124710 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 01:21:45.101447 => 01:21:45.124274
[0m01:21:45.125403 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m01:21:45.126211 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m01:21:45.127564 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m01:21:45.130936 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
[0m01:21:45.132936 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m01:21:45.210358 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:45.211287 [debug] [MainThread]: On master: BEGIN
[0m01:21:45.212027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:21:45.224660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:45.225216 [debug] [MainThread]: On master: COMMIT
[0m01:21:45.225677 [debug] [MainThread]: Using duckdb connection "master"
[0m01:21:45.226131 [debug] [MainThread]: On master: COMMIT
[0m01:21:45.226722 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:21:45.227195 [debug] [MainThread]: On master: Close
[0m01:21:45.229331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:21:45.229781 [debug] [MainThread]: Connection 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m01:21:45.230263 [info ] [MainThread]: 
[0m01:21:45.230866 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m01:21:45.232971 [debug] [MainThread]: Command end result
[0m01:21:45.241929 [info ] [MainThread]: 
[0m01:21:45.242597 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:21:45.243137 [info ] [MainThread]: 
[0m01:21:45.243691 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m01:21:45.244215 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m01:21:45.244811 [info ] [MainThread]: 
[0m01:21:45.245320 [info ] [MainThread]:   compiled Code at target/compiled/footprint_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m01:21:45.245836 [info ] [MainThread]: 
[0m01:21:45.246427 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m01:21:45.247229 [debug] [MainThread]: Command `dbt test` failed at 01:21:45.247063 after 0.76 seconds
[0m01:21:45.247739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb0dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb23310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7dc210>]}
[0m01:21:45.248256 [debug] [MainThread]: Flushing usage events
[0m01:22:54.309239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e89db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e89df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e89df50>]}


============================== 01:22:54.312898 | a68d555e-c71a-49e9-a499-a812c7f82f18 ==============================
[0m01:22:54.312898 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:22:54.313828 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'target_path': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'debug': 'False'}
[0m01:22:54.449975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e905e90>]}
[0m01:22:54.469354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e973ad0>]}
[0m01:22:54.470035 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:22:54.484369 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:22:54.494148 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:22:54.495353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a7d50>]}
[0m01:22:55.445648 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m01:22:55.462150 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m01:22:55.466251 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m01:22:55.470352 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m01:22:55.567227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab1b90>]}
[0m01:22:55.575590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eadb0d0>]}
[0m01:22:55.576270 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:22:55.576780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a68d555e-c71a-49e9-a499-a812c7f82f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eadbe50>]}
[0m01:22:55.578500 [info ] [MainThread]: 
[0m01:22:55.579480 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:22:55.580912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:22:55.598337 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:22:55.598920 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:22:55.599335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:55.613874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:55.614406 [debug] [MainThread]: Connection 'list_footprint' was properly closed.
[0m01:22:55.614849 [info ] [MainThread]: 
[0m01:22:55.615410 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m01:22:55.616078 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/ingestion/data/transform/footprint.duckdb": No such file or directory
[0m01:22:55.616872 [debug] [MainThread]: Command `dbt run` failed at 01:22:55.616703 after 1.33 seconds
[0m01:22:55.617470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8bd210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8bd250>]}
[0m01:22:55.618165 [debug] [MainThread]: Flushing usage events
[0m01:23:07.780349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cbe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cbed0>]}


============================== 01:23:07.783918 | 0bf89428-13a6-4733-bae0-4d28e600b64a ==============================
[0m01:23:07.783918 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:23:07.784805 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m01:23:07.918016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112534fd0>]}
[0m01:23:07.937479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eb090>]}
[0m01:23:07.938201 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:23:07.950923 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:23:07.959787 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:23:07.960319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a1dd0>]}
[0m01:23:08.901716 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m01:23:08.917709 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m01:23:08.921970 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m01:23:08.926116 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m01:23:09.026212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11262c290>]}
[0m01:23:09.036052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270b510>]}
[0m01:23:09.036696 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:23:09.037246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf89428-13a6-4733-bae0-4d28e600b64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11270bd90>]}
[0m01:23:09.039074 [info ] [MainThread]: 
[0m01:23:09.040063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:23:09.041519 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:23:09.061000 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:23:09.061597 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:23:09.062036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:09.070192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:09.070752 [debug] [MainThread]: Connection 'list_footprint' was properly closed.
[0m01:23:09.071179 [info ] [MainThread]: 
[0m01:23:09.071861 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m01:23:09.073152 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/./ingestion/data/transform/footprint.duckdb": No such file or directory
[0m01:23:09.074534 [debug] [MainThread]: Command `dbt run` failed at 01:23:09.074292 after 1.32 seconds
[0m01:23:09.075093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eb2d0>]}
[0m01:23:09.075628 [debug] [MainThread]: Flushing usage events
[0m01:23:53.748137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106ed0>]}


============================== 01:23:53.751758 | 99d47ddd-4a7e-4aec-bc85-e2dbd43f428f ==============================
[0m01:23:53.751758 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:23:53.752685 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False'}
[0m01:23:53.887356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d47ddd-4a7e-4aec-bc85-e2dbd43f428f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813a310>]}
[0m01:23:53.906547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d47ddd-4a7e-4aec-bc85-e2dbd43f428f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e6650>]}
[0m01:23:53.907205 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:23:53.922178 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:23:53.960673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:53.961173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:53.969522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d47ddd-4a7e-4aec-bc85-e2dbd43f428f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108289390>]}
[0m01:23:53.977845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d47ddd-4a7e-4aec-bc85-e2dbd43f428f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828ad90>]}
[0m01:23:53.978434 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:23:53.978943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d47ddd-4a7e-4aec-bc85-e2dbd43f428f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828a510>]}
[0m01:23:53.980843 [info ] [MainThread]: 
[0m01:23:53.981845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:23:53.983304 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:23:54.058964 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:23:54.059571 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:23:54.060053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:54.068265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:54.068725 [debug] [MainThread]: Connection 'list_footprint' was properly closed.
[0m01:23:54.069191 [info ] [MainThread]: 
[0m01:23:54.069809 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m01:23:54.070549 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/./ingestion/data/transform/footprint.duckdb": No such file or directory
[0m01:23:54.071522 [debug] [MainThread]: Command `dbt run` failed at 01:23:54.071339 after 0.35 seconds
[0m01:23:54.072036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108222410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a84a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839a310>]}
[0m01:23:54.072554 [debug] [MainThread]: Flushing usage events
[0m01:24:15.672807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083ef90>]}


============================== 01:24:15.676319 | 63a7d562-b5b2-4a20-909c-f40ca15faa39 ==============================
[0m01:24:15.676319 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:24:15.677245 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m01:24:15.811134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108726d0>]}
[0m01:24:15.830561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11024eb10>]}
[0m01:24:15.831223 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:24:15.843896 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:24:15.853593 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:24:15.855135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11095ab10>]}
[0m01:24:16.817811 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m01:24:16.833744 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m01:24:16.837880 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m01:24:16.842002 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m01:24:16.943395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac98d0>]}
[0m01:24:16.950757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5e950>]}
[0m01:24:16.951312 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:24:16.951769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5edd0>]}
[0m01:24:16.953310 [info ] [MainThread]: 
[0m01:24:16.954188 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:24:16.955413 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:24:16.970453 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:24:16.970860 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:24:16.971218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:16.987116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:16.988980 [debug] [ThreadPool]: On list_footprint: Close
[0m01:24:16.991738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m01:24:16.992712 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m01:24:17.002204 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:24:17.003330 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m01:24:17.004316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:17.016168 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:17.016737 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:24:17.017185 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m01:24:17.017834 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:17.019048 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:24:17.019505 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:24:17.019931 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:24:17.020495 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:17.020953 [debug] [ThreadPool]: On create_footprint_main: Close
[0m01:24:17.024693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m01:24:17.033881 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:24:17.034362 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m01:24:17.034775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:17.045346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:17.045918 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:24:17.046379 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m01:24:17.058280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:24:17.060104 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m01:24:17.060841 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m01:24:17.061262 [debug] [ThreadPool]: On list_footprint_main: Close
[0m01:24:17.065276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bbc8d0>]}
[0m01:24:17.065880 [debug] [MainThread]: Using duckdb connection "master"
[0m01:24:17.066316 [debug] [MainThread]: On master: BEGIN
[0m01:24:17.066738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:24:17.077430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:24:17.077951 [debug] [MainThread]: On master: COMMIT
[0m01:24:17.078395 [debug] [MainThread]: Using duckdb connection "master"
[0m01:24:17.078818 [debug] [MainThread]: On master: COMMIT
[0m01:24:17.079372 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:24:17.079817 [debug] [MainThread]: On master: Close
[0m01:24:17.081871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:17.082427 [info ] [MainThread]: 
[0m01:24:17.084320 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m01:24:17.085329 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m01:24:17.086316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m01:24:17.086869 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m01:24:17.099610 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.100786 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 01:24:17.087240 => 01:24:17.100415
[0m01:24:17.101358 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m01:24:17.155551 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.156458 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.156919 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m01:24:17.157348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:24:17.165954 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.166476 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.166960 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m01:24:17.168140 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.175996 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.176488 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:24:17.177279 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.181213 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.181677 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:24:17.182417 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.208839 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:24:17.209344 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.209842 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:24:17.211512 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.218661 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:24:17.219144 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m01:24:17.220186 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.221918 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 01:24:17.101718 => 01:24:17.221641
[0m01:24:17.222402 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m01:24:17.226680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5c890>]}
[0m01:24:17.227468 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m01:24:17.228363 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m01:24:17.228960 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m01:24:17.229539 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m01:24:17.230577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m01:24:17.231127 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m01:24:17.236496 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m01:24:17.237704 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 01:24:17.231470 => 01:24:17.237348
[0m01:24:17.238266 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m01:24:17.273872 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m01:24:17.274948 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.275512 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m01:24:17.276039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:24:17.286017 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.286644 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.287202 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m01:24:17.288077 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.292819 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.293390 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint" rename to "stg_footprint__dbt_backup"
[0m01:24:17.294202 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.298552 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.299102 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m01:24:17.299840 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.302313 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:24:17.302847 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.303364 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:24:17.304565 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.308656 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:24:17.309219 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m01:24:17.310272 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.312204 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 01:24:17.238621 => 01:24:17.311888
[0m01:24:17.312764 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m01:24:17.317014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5c890>]}
[0m01:24:17.317937 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.09s]
[0m01:24:17.319015 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m01:24:17.319711 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m01:24:17.320360 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m01:24:17.321380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m01:24:17.321943 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m01:24:17.327629 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.328970 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 01:24:17.322313 => 01:24:17.328599
[0m01:24:17.329546 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m01:24:17.335584 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.336525 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.337078 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m01:24:17.337600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:24:17.349789 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.350864 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.351841 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m01:24:17.352991 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.359574 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.360673 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m01:24:17.362303 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.367916 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.368597 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:24:17.369517 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.373807 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:24:17.374427 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.375026 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:24:17.376353 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.381481 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:24:17.383007 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m01:24:17.384515 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.387921 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 01:24:17.329925 => 01:24:17.387362
[0m01:24:17.388698 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m01:24:17.393248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d09cd0>]}
[0m01:24:17.394187 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m01:24:17.395318 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m01:24:17.396076 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m01:24:17.396785 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m01:24:17.398427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m01:24:17.399418 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m01:24:17.405201 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m01:24:17.406479 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 01:24:17.400088 => 01:24:17.406054
[0m01:24:17.407133 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m01:24:17.414002 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m01:24:17.415663 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.416451 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m01:24:17.417089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:24:17.429274 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.429956 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.430758 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m01:24:17.437192 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.443992 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.445170 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends" rename to "country_trends__dbt_backup"
[0m01:24:17.446217 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.451281 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.451909 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m01:24:17.452753 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.455806 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:24:17.456435 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.456998 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:24:17.458664 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.462933 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:24:17.463535 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m01:24:17.464694 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:24:17.466729 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 01:24:17.407550 => 01:24:17.466393
[0m01:24:17.467330 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m01:24:17.474373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63a7d562-b5b2-4a20-909c-f40ca15faa39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf0090>]}
[0m01:24:17.475312 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.08s]
[0m01:24:17.476382 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m01:24:17.512113 [debug] [MainThread]: Using duckdb connection "master"
[0m01:24:17.513076 [debug] [MainThread]: On master: BEGIN
[0m01:24:17.513839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:24:17.526105 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:24:17.526683 [debug] [MainThread]: On master: COMMIT
[0m01:24:17.527157 [debug] [MainThread]: Using duckdb connection "master"
[0m01:24:17.527617 [debug] [MainThread]: On master: COMMIT
[0m01:24:17.528221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:24:17.528689 [debug] [MainThread]: On master: Close
[0m01:24:17.530819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:24:17.531266 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m01:24:17.531767 [info ] [MainThread]: 
[0m01:24:17.532371 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m01:24:17.534530 [debug] [MainThread]: Command end result
[0m01:24:17.543449 [info ] [MainThread]: 
[0m01:24:17.544089 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:24:17.544625 [info ] [MainThread]: 
[0m01:24:17.545220 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:24:17.546011 [debug] [MainThread]: Command `dbt run` succeeded at 01:24:17.545848 after 1.90 seconds
[0m01:24:17.546504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ac98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085e310>]}
[0m01:24:17.547000 [debug] [MainThread]: Flushing usage events
[0m01:26:31.095660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e5ed0>]}


============================== 01:26:31.099215 | b4c5cc25-9781-41cf-99eb-0e1807727ab4 ==============================
[0m01:26:31.099215 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:26:31.100123 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m01:26:31.236821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fa0d0>]}
[0m01:26:31.256184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571ac50>]}
[0m01:26:31.256877 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:26:31.269750 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:26:31.280390 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m01:26:31.281348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705b50>]}
[0m01:26:32.242836 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_footprint.sql
[0m01:26:32.258978 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m01:26:32.263151 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m01:26:32.267309 [debug] [MainThread]: 1699: static parser successfully parsed marts/country_trends.sql
[0m01:26:32.365499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575a210>]}
[0m01:26:32.373014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fdf90>]}
[0m01:26:32.373561 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:26:32.374017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fd990>]}
[0m01:26:32.375590 [info ] [MainThread]: 
[0m01:26:32.376431 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:32.377661 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:26:32.394745 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:26:32.395312 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:26:32.395751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:32.413095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.415018 [debug] [ThreadPool]: On list_footprint: Close
[0m01:26:32.417703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m01:26:32.418659 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m01:26:32.426113 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:26:32.426560 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m01:26:32.426960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:32.436864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.437361 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:26:32.437789 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m01:26:32.438416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.439571 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:26:32.440001 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:26:32.440406 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:26:32.440938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.441355 [debug] [ThreadPool]: On create_footprint_main: Close
[0m01:26:32.444658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m01:26:32.453235 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:26:32.453680 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m01:26:32.454077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:32.463989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.464462 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:26:32.464885 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m01:26:32.474807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:26:32.476106 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m01:26:32.476722 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m01:26:32.477109 [debug] [ThreadPool]: On list_footprint_main: Close
[0m01:26:32.479191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104919110>]}
[0m01:26:32.479685 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:32.480039 [debug] [MainThread]: On master: BEGIN
[0m01:26:32.480376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:32.488102 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:26:32.488508 [debug] [MainThread]: On master: COMMIT
[0m01:26:32.488861 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:32.489206 [debug] [MainThread]: On master: COMMIT
[0m01:26:32.489702 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:26:32.490062 [debug] [MainThread]: On master: Close
[0m01:26:32.491715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:32.492230 [info ] [MainThread]: 
[0m01:26:32.493777 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m01:26:32.494364 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m01:26:32.495177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m01:26:32.495620 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m01:26:32.505988 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.508246 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 01:26:32.495921 => 01:26:32.507727
[0m01:26:32.508863 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m01:26:32.563982 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.564884 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.565351 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m01:26:32.565783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:32.574509 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.575031 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.575513 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m01:26:32.576752 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.584812 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.585295 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:26:32.585986 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.610286 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:26:32.610784 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.611273 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:26:32.612468 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.619353 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:26:32.619832 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m01:26:32.620511 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.622162 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 01:26:32.509187 => 01:26:32.621893
[0m01:26:32.622792 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m01:26:32.626424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa1210>]}
[0m01:26:32.627199 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.13s]
[0m01:26:32.628127 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m01:26:32.628705 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m01:26:32.629243 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m01:26:32.630221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m01:26:32.630659 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m01:26:32.632963 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m01:26:32.633991 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 01:26:32.630957 => 01:26:32.633679
[0m01:26:32.634484 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m01:26:32.668054 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m01:26:32.669171 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:26:32.669729 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m01:26:32.670247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:32.680197 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.680832 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:26:32.681387 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m01:26:32.693850 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 01:26:32.634822 => 01:26:32.693400
[0m01:26:32.694524 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: ROLLBACK
[0m01:26:32.710266 [debug] [Thread-1  ]: Failed to rollback 'model.footprint_dbt.stg_footprint'
[0m01:26:32.710975 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m01:26:32.714266 [debug] [Thread-1  ]: Runtime Error in model stg_footprint (models/staging/stg_footprint.sql)
  Catalog Error: Table with name raw_footprint does not exist!
  Did you mean "pg_constraint"?
  
  LINE 10: FROM raw_footprint
                ^
[0m01:26:32.714897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae8a50>]}
[0m01:26:32.715818 [error] [Thread-1  ]: 2 of 4 ERROR creating sql view model main.stg_footprint ........................ [[31mERROR[0m in 0.09s]
[0m01:26:32.716672 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m01:26:32.717364 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m01:26:32.718066 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m01:26:32.719359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m01:26:32.719946 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m01:26:32.724286 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.725363 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 01:26:32.720341 => 01:26:32.724999
[0m01:26:32.725956 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m01:26:32.734359 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.736282 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.737026 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m01:26:32.737634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:26:32.749370 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.750097 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.750721 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m01:26:32.751637 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.758913 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.759724 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:26:32.760901 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.764262 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:26:32.764979 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.765574 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:26:32.767015 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.771265 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:26:32.771942 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m01:26:32.772755 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:26:32.774900 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 01:26:32.726337 => 01:26:32.774546
[0m01:26:32.775533 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m01:26:32.779410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c5cc25-9781-41cf-99eb-0e1807727ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0c790>]}
[0m01:26:32.780454 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m01:26:32.781577 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m01:26:32.782332 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m01:26:32.782989 [info ] [Thread-1  ]: 4 of 4 SKIP relation main.country_trends ....................................... [[33mSKIP[0m]
[0m01:26:32.783918 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m01:26:32.810514 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:32.811345 [debug] [MainThread]: On master: BEGIN
[0m01:26:32.811936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:32.824447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:26:32.825098 [debug] [MainThread]: On master: COMMIT
[0m01:26:32.825573 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:32.826041 [debug] [MainThread]: On master: COMMIT
[0m01:26:32.827144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:26:32.828095 [debug] [MainThread]: On master: Close
[0m01:26:32.830447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:32.830942 [debug] [MainThread]: Connection 'model.footprint_dbt.my_second_dbt_model' was properly closed.
[0m01:26:32.831455 [info ] [MainThread]: 
[0m01:26:32.832076 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:26:32.833813 [debug] [MainThread]: Command end result
[0m01:26:32.845449 [info ] [MainThread]: 
[0m01:26:32.846222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:26:32.846798 [info ] [MainThread]: 
[0m01:26:32.847362 [error] [MainThread]: [33mRuntime Error in model stg_footprint (models/staging/stg_footprint.sql)[0m
[0m01:26:32.847916 [error] [MainThread]:   Catalog Error: Table with name raw_footprint does not exist!
[0m01:26:32.848459 [error] [MainThread]:   Did you mean "pg_constraint"?
[0m01:26:32.848991 [error] [MainThread]:   
[0m01:26:32.849524 [error] [MainThread]:   LINE 10: FROM raw_footprint
[0m01:26:32.850056 [error] [MainThread]:                 ^
[0m01:26:32.850621 [info ] [MainThread]: 
[0m01:26:32.851280 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m01:26:32.852167 [debug] [MainThread]: Command `dbt run` failed at 01:26:32.851989 after 1.78 seconds
[0m01:26:32.852717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705410>]}
[0m01:26:32.853287 [debug] [MainThread]: Flushing usage events
[0m01:26:59.707204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ddb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dde90>]}


============================== 01:26:59.710785 | b11aaac8-6eaf-4713-a6b1-75ff172b9326 ==============================
[0m01:26:59.710785 [info ] [MainThread]: Running with dbt=1.5.11
[0m01:26:59.711704 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m01:26:59.850864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146e10>]}
[0m01:26:59.870659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fdb50>]}
[0m01:26:59.871389 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m01:26:59.884716 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m01:26:59.922664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:59.923167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:59.931501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105258450>]}
[0m01:26:59.940041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052616d0>]}
[0m01:26:59.940664 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:26:59.941209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052616d0>]}
[0m01:26:59.943153 [info ] [MainThread]: 
[0m01:26:59.944159 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:59.945632 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m01:27:00.020874 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m01:27:00.021502 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m01:27:00.022000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:00.038969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.040892 [debug] [ThreadPool]: On list_footprint: Close
[0m01:27:00.043728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m01:27:00.044790 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m01:27:00.052515 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:27:00.053013 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m01:27:00.053491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:00.064295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.064807 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:27:00.065242 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m01:27:00.065866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.067039 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:27:00.067480 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m01:27:00.067951 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m01:27:00.068510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.068948 [debug] [ThreadPool]: On create_footprint_main: Close
[0m01:27:00.072486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m01:27:00.081277 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:27:00.081733 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m01:27:00.082139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:00.092185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.092694 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m01:27:00.093191 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m01:27:00.104676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m01:27:00.106230 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m01:27:00.106893 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m01:27:00.107251 [debug] [ThreadPool]: On list_footprint_main: Close
[0m01:27:00.110202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105152ed0>]}
[0m01:27:00.110752 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:00.111140 [debug] [MainThread]: On master: BEGIN
[0m01:27:00.111529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:00.120177 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:27:00.120627 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.120998 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:00.121352 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.121821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:27:00.122197 [debug] [MainThread]: On master: Close
[0m01:27:00.124008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:27:00.124490 [info ] [MainThread]: 
[0m01:27:00.126087 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m01:27:00.126883 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m01:27:00.127745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m01:27:00.128218 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m01:27:00.139772 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.140903 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 01:27:00.128556 => 01:27:00.140563
[0m01:27:00.141531 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m01:27:00.196313 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.197218 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.197684 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m01:27:00.198126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:27:00.207049 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.207593 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.208130 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m01:27:00.209172 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.216968 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.217468 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m01:27:00.218172 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.222652 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.223135 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m01:27:00.223784 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.250404 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:27:00.250924 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.251377 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m01:27:00.253082 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.260236 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m01:27:00.260734 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m01:27:00.261790 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.263586 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 01:27:00.141881 => 01:27:00.263297
[0m01:27:00.264100 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m01:27:00.267835 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054012d0>]}
[0m01:27:00.268621 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m01:27:00.269524 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m01:27:00.270130 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m01:27:00.270832 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m01:27:00.272017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m01:27:00.272564 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m01:27:00.276428 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m01:27:00.277708 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 01:27:00.272951 => 01:27:00.277348
[0m01:27:00.278274 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m01:27:00.312837 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m01:27:00.313931 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:27:00.314511 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m01:27:00.315056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:27:00.326732 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.327766 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:27:00.328801 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m01:27:00.330051 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.334846 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:27:00.335468 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m01:27:00.336268 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.338455 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:27:00.339018 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:27:00.339645 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m01:27:00.340889 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.344651 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m01:27:00.345211 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m01:27:00.345944 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.347876 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 01:27:00.278632 => 01:27:00.347551
[0m01:27:00.348446 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m01:27:00.352355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a0690>]}
[0m01:27:00.353274 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.08s]
[0m01:27:00.354315 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m01:27:00.355037 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m01:27:00.356087 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m01:27:00.357306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m01:27:00.358714 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m01:27:00.364940 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.366465 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 01:27:00.359878 => 01:27:00.366017
[0m01:27:00.367222 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m01:27:00.373882 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.375037 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.375794 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m01:27:00.376407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:27:00.388859 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.389569 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.390168 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m01:27:00.391942 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.400560 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.401345 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m01:27:00.402906 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.408472 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.409145 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m01:27:00.410055 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.413040 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:27:00.413646 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.414228 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m01:27:00.415541 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.420239 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m01:27:00.421035 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m01:27:00.422831 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.426123 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 01:27:00.367634 => 01:27:00.425716
[0m01:27:00.426857 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m01:27:00.431724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cc110>]}
[0m01:27:00.432717 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m01:27:00.433854 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m01:27:00.434622 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m01:27:00.435333 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m01:27:00.436423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m01:27:00.437109 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m01:27:00.442192 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m01:27:00.444787 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 01:27:00.437531 => 01:27:00.444194
[0m01:27:00.445552 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m01:27:00.451696 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m01:27:00.452743 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:27:00.453334 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m01:27:00.453893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:27:00.466676 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.467895 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:27:00.469165 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m01:27:00.475026 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.480115 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:27:00.480738 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m01:27:00.481627 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.484301 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:27:00.484884 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:27:00.485424 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m01:27:00.486959 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.490864 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m01:27:00.491423 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m01:27:00.492164 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m01:27:00.494121 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 01:27:00.445982 => 01:27:00.493798
[0m01:27:00.494693 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m01:27:00.501633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b11aaac8-6eaf-4713-a6b1-75ff172b9326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c3e50>]}
[0m01:27:00.502535 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.07s]
[0m01:27:00.503582 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m01:27:00.547908 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:00.548823 [debug] [MainThread]: On master: BEGIN
[0m01:27:00.549569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:00.561601 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:27:00.562174 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.562647 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:00.563105 [debug] [MainThread]: On master: COMMIT
[0m01:27:00.563707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m01:27:00.564173 [debug] [MainThread]: On master: Close
[0m01:27:00.566232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:00.566679 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m01:27:00.567172 [info ] [MainThread]: 
[0m01:27:00.567768 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m01:27:00.570104 [debug] [MainThread]: Command end result
[0m01:27:00.584107 [info ] [MainThread]: 
[0m01:27:00.584852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:00.585428 [info ] [MainThread]: 
[0m01:27:00.586066 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:27:00.586925 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:00.586749 after 0.91 seconds
[0m01:27:00.587450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015ea4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054890d0>]}
[0m01:27:00.587979 [debug] [MainThread]: Flushing usage events
[0m02:14:36.496259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f79df50>]}


============================== 02:14:36.500650 | f38f1633-a8bf-4e97-bc97-a383c8d81050 ==============================
[0m02:14:36.500650 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:14:36.501662 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'write_json': 'True'}
[0m02:14:36.630851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d607a90>]}
[0m02:14:36.650402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ba8d0>]}
[0m02:14:36.651087 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:14:36.665443 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:14:36.703829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:14:36.704278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:14:36.712175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f816290>]}
[0m02:14:36.722086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f923a90>]}
[0m02:14:36.722955 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:14:36.723672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f923590>]}
[0m02:14:36.725760 [info ] [MainThread]: 
[0m02:14:36.726984 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:14:36.729334 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m02:14:36.800242 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m02:14:36.800878 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m02:14:36.801381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:36.820826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.822859 [debug] [ThreadPool]: On list_footprint: Close
[0m02:14:36.825797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m02:14:36.826965 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m02:14:36.834679 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:14:36.835222 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m02:14:36.835673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:36.846700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.847240 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:14:36.847675 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m02:14:36.848303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.849483 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:14:36.849922 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:14:36.850333 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:14:36.850931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.851381 [debug] [ThreadPool]: On create_footprint_main: Close
[0m02:14:36.854865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m02:14:36.863861 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:14:36.864369 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:14:36.864775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:36.875097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.875690 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:14:36.876141 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:14:36.887899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:36.889683 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:14:36.890429 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:14:36.890830 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:14:36.894797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f87ea90>]}
[0m02:14:36.895405 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:36.895825 [debug] [MainThread]: On master: BEGIN
[0m02:14:36.896215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:14:36.905757 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:36.906309 [debug] [MainThread]: On master: COMMIT
[0m02:14:36.906731 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:36.907139 [debug] [MainThread]: On master: COMMIT
[0m02:14:36.907767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:36.908244 [debug] [MainThread]: On master: Close
[0m02:14:36.910358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:14:36.910888 [info ] [MainThread]: 
[0m02:14:36.912912 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m02:14:36.913605 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m02:14:36.914546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m02:14:36.915066 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m02:14:36.926543 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m02:14:36.928588 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 02:14:36.915428 => 02:14:36.928142
[0m02:14:36.929248 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m02:14:36.992619 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m02:14:36.994782 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:36.995440 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m02:14:36.995975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:37.007077 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.007730 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:37.008357 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m02:14:37.009574 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.018916 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:37.019589 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:14:37.020530 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.026331 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:37.026950 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:14:37.027783 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.059657 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:14:37.060289 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:37.060806 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:14:37.062757 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.071398 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:14:37.072045 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m02:14:37.073195 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.075196 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 02:14:36.929625 => 02:14:37.074876
[0m02:14:37.075750 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m02:14:37.080562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa86bd0>]}
[0m02:14:37.081490 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.17s]
[0m02:14:37.082510 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m02:14:37.083207 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m02:14:37.083850 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m02:14:37.084800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m02:14:37.085322 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m02:14:37.088155 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m02:14:37.089576 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 02:14:37.085678 => 02:14:37.089111
[0m02:14:37.090285 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m02:14:37.120562 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m02:14:37.121613 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.122143 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m02:14:37.122643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:37.132474 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.133119 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.133653 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m02:14:37.134512 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.139214 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.139901 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint" rename to "stg_footprint__dbt_backup"
[0m02:14:37.140705 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.144987 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.145565 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m02:14:37.146339 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.148789 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:14:37.149311 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.149810 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:14:37.151062 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.155099 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:14:37.155692 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m02:14:37.156713 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.158655 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 02:14:37.090662 => 02:14:37.158339
[0m02:14:37.159202 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m02:14:37.163162 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faf4a10>]}
[0m02:14:37.164032 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.08s]
[0m02:14:37.165012 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m02:14:37.165840 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m02:14:37.166461 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m02:14:37.167374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m02:14:37.167875 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m02:14:37.171885 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.173216 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 02:14:37.168218 => 02:14:37.172836
[0m02:14:37.173778 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m02:14:37.181017 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.182047 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.182589 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m02:14:37.183096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:37.192866 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.193497 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.194264 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m02:14:37.195229 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.199783 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.200413 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m02:14:37.201155 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.205559 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.206129 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:14:37.206934 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.209279 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:14:37.209805 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.210328 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:14:37.211649 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.215559 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:14:37.216105 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m02:14:37.217055 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.219123 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 02:14:37.174129 => 02:14:37.218783
[0m02:14:37.219711 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m02:14:37.224185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb13e90>]}
[0m02:14:37.225115 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m02:14:37.226127 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m02:14:37.226879 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m02:14:37.227578 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m02:14:37.228570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m02:14:37.229094 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m02:14:37.233281 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m02:14:37.235719 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 02:14:37.229454 => 02:14:37.234918
[0m02:14:37.236605 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m02:14:37.242458 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m02:14:37.243621 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.244190 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m02:14:37.244703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:37.255456 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.256103 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.256649 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m02:14:37.263800 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.268474 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.269094 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends" rename to "country_trends__dbt_backup"
[0m02:14:37.269992 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.274621 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.275193 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m02:14:37.276085 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.278913 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:14:37.279460 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.279986 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:14:37.281743 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.286072 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:14:37.286746 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m02:14:37.288043 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:37.290387 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 02:14:37.236987 => 02:14:37.290035
[0m02:14:37.291010 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m02:14:37.301219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f38f1633-a8bf-4e97-bc97-a383c8d81050', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa97d10>]}
[0m02:14:37.302135 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.07s]
[0m02:14:37.303499 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m02:14:37.326795 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:37.327718 [debug] [MainThread]: On master: BEGIN
[0m02:14:37.328460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:14:37.341298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:37.341893 [debug] [MainThread]: On master: COMMIT
[0m02:14:37.342370 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:37.342810 [debug] [MainThread]: On master: COMMIT
[0m02:14:37.343384 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:37.343848 [debug] [MainThread]: On master: Close
[0m02:14:37.345950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:37.346432 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m02:14:37.346931 [info ] [MainThread]: 
[0m02:14:37.347512 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:14:37.349511 [debug] [MainThread]: Command end result
[0m02:14:37.359246 [info ] [MainThread]: 
[0m02:14:37.359883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:14:37.360383 [info ] [MainThread]: 
[0m02:14:37.360945 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:14:37.361706 [debug] [MainThread]: Command `dbt run` succeeded at 02:14:37.361544 after 0.90 seconds
[0m02:14:37.362186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f923c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9987d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f998dd0>]}
[0m02:14:37.362678 [debug] [MainThread]: Flushing usage events
[0m02:14:40.359595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef78c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef78f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef78fd0>]}


============================== 02:14:40.363064 | b24a98a9-a687-480e-812b-a792f9c0e727 ==============================
[0m02:14:40.363064 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:14:40.363917 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'quiet': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True'}
[0m02:14:40.491678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efe1f10>]}
[0m02:14:40.513282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efad290>]}
[0m02:14:40.514107 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:14:40.527394 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:14:40.558513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:14:40.558961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:14:40.566445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0de550>]}
[0m02:14:40.575250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fcf10>]}
[0m02:14:40.575945 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:14:40.576535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fc2d0>]}
[0m02:14:40.578744 [info ] [MainThread]: 
[0m02:14:40.579885 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:14:40.581464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint_main'
[0m02:14:40.649875 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:14:40.650503 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:14:40.651012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:40.667630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:40.668224 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:14:40.668716 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:14:40.682056 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:14:40.684218 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:14:40.685046 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:14:40.685489 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:14:40.689681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b24a98a9-a687-480e-812b-a792f9c0e727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f020c90>]}
[0m02:14:40.690296 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:40.690739 [debug] [MainThread]: On master: BEGIN
[0m02:14:40.691172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:14:40.701727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:40.702286 [debug] [MainThread]: On master: COMMIT
[0m02:14:40.702718 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:40.703133 [debug] [MainThread]: On master: COMMIT
[0m02:14:40.703675 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:40.704106 [debug] [MainThread]: On master: Close
[0m02:14:40.706159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:14:40.706691 [info ] [MainThread]: 
[0m02:14:40.708894 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:14:40.709537 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m02:14:40.710571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m02:14:40.711106 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:14:40.737425 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:14:40.739862 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 02:14:40.711466 => 02:14:40.739384
[0m02:14:40.740513 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:14:40.762598 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:14:40.763678 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:14:40.764211 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m02:14:40.764784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:40.774954 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.775563 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:14:40.776106 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m02:14:40.777627 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.780866 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 02:14:40.740945 => 02:14:40.780506
[0m02:14:40.781481 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m02:14:40.782100 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m02:14:40.782613 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m02:14:40.785165 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
[0m02:14:40.786327 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:14:40.787026 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:14:40.787607 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m02:14:40.788560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m02:14:40.789072 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:14:40.795136 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:14:40.796338 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 02:14:40.789423 => 02:14:40.795930
[0m02:14:40.796895 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:14:40.800696 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:14:40.801872 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:14:40.802443 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m02:14:40.802962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:40.814279 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.814948 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:14:40.815508 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m02:14:40.816808 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.819057 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 02:14:40.797298 => 02:14:40.818672
[0m02:14:40.819799 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m02:14:40.820438 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m02:14:40.820961 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m02:14:40.823360 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m02:14:40.824389 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:14:40.825097 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:14:40.825669 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m02:14:40.826616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m02:14:40.827146 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:14:40.837850 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:14:40.839400 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 02:14:40.827603 => 02:14:40.838956
[0m02:14:40.840010 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:14:40.844227 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:14:40.846806 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:14:40.847397 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m02:14:40.847929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:40.859035 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.859751 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:14:40.860327 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:14:40.862025 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.864364 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 02:14:40.840369 => 02:14:40.863868
[0m02:14:40.865109 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m02:14:40.865936 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m02:14:40.866504 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m02:14:40.870087 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m02:14:40.871742 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:14:40.872531 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:14:40.873248 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m02:14:40.874567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321, now test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m02:14:40.875504 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:14:40.882461 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:14:40.884795 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 02:14:40.876213 => 02:14:40.884297
[0m02:14:40.885478 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:14:40.889227 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:14:40.890209 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:14:40.890787 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m02:14:40.891347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:14:40.901233 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.901853 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:14:40.902416 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:14:40.903826 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:14:40.905926 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 02:14:40.885869 => 02:14:40.905583
[0m02:14:40.906499 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m02:14:40.907101 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m02:14:40.907613 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m02:14:40.909931 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
[0m02:14:40.910957 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:14:40.917809 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:40.918415 [debug] [MainThread]: On master: BEGIN
[0m02:14:40.918882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:14:40.929737 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:40.930253 [debug] [MainThread]: On master: COMMIT
[0m02:14:40.930675 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:40.931081 [debug] [MainThread]: On master: COMMIT
[0m02:14:40.931614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:14:40.932044 [debug] [MainThread]: On master: Close
[0m02:14:40.933993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:40.934400 [debug] [MainThread]: Connection 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m02:14:40.934836 [info ] [MainThread]: 
[0m02:14:40.935378 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m02:14:40.937294 [debug] [MainThread]: Command end result
[0m02:14:40.945148 [info ] [MainThread]: 
[0m02:14:40.945732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:14:40.946257 [info ] [MainThread]: 
[0m02:14:40.946760 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m02:14:40.947235 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:14:40.947700 [info ] [MainThread]: 
[0m02:14:40.948168 [info ] [MainThread]:   compiled Code at target/compiled/footprint_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m02:14:40.948651 [info ] [MainThread]: 
[0m02:14:40.949197 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m02:14:40.949930 [debug] [MainThread]: Command `dbt test` failed at 02:14:40.949777 after 0.62 seconds
[0m02:14:40.950407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef92490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0de1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f020c90>]}
[0m02:14:40.950889 [debug] [MainThread]: Flushing usage events
[0m02:19:29.085209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f5b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f5e50>]}


============================== 02:19:29.089048 | 630cbd17-97cb-4e41-9f2c-7e6012516549 ==============================
[0m02:19:29.089048 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:19:29.089937 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'quiet': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True'}
[0m02:19:29.216346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11116c2d0>]}
[0m02:19:29.235707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cd8d0>]}
[0m02:19:29.236425 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:19:29.249296 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:19:29.281275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:19:29.281711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:19:29.289486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111117b90>]}
[0m02:19:29.300008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127ad10>]}
[0m02:19:29.300703 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:19:29.301282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127ad10>]}
[0m02:19:29.303370 [info ] [MainThread]: 
[0m02:19:29.304449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:19:29.305995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m02:19:29.371747 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m02:19:29.372339 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m02:19:29.372805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:29.389943 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.391883 [debug] [ThreadPool]: On list_footprint: Close
[0m02:19:29.394598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m02:19:29.395657 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m02:19:29.402919 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:19:29.403362 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m02:19:29.403763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:29.414367 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.414869 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:19:29.415290 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m02:19:29.415906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.417070 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:19:29.417499 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:19:29.417900 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:19:29.418447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.418857 [debug] [ThreadPool]: On create_footprint_main: Close
[0m02:19:29.422275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m02:19:29.430885 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:19:29.431327 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:19:29.431715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:29.441680 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.442155 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:19:29.442583 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:19:29.453780 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:29.455301 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:19:29.455939 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:19:29.456292 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:19:29.459628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125efd0>]}
[0m02:19:29.460174 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:29.460534 [debug] [MainThread]: On master: BEGIN
[0m02:19:29.460870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:29.469430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:29.469872 [debug] [MainThread]: On master: COMMIT
[0m02:19:29.470224 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:29.470566 [debug] [MainThread]: On master: COMMIT
[0m02:19:29.471015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:29.471380 [debug] [MainThread]: On master: Close
[0m02:19:29.473206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:29.473656 [info ] [MainThread]: 
[0m02:19:29.475458 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m02:19:29.476058 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m02:19:29.476871 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m02:19:29.477319 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m02:19:29.487097 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.488028 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 02:19:29.477623 => 02:19:29.487727
[0m02:19:29.488497 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m02:19:29.538778 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.539847 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.540372 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m02:19:29.540863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:29.550339 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.550929 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.551467 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m02:19:29.552703 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.561573 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.562135 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:19:29.562972 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.568148 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.568690 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:19:29.569487 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.596798 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:19:29.597310 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.597757 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:19:29.599515 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.606869 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:19:29.607349 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m02:19:29.608410 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.610164 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 02:19:29.488790 => 02:19:29.609883
[0m02:19:29.610646 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m02:19:29.614850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111283ad0>]}
[0m02:19:29.615601 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m02:19:29.616474 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m02:19:29.617069 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m02:19:29.617648 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m02:19:29.618490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m02:19:29.618958 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m02:19:29.621519 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m02:19:29.622584 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 02:19:29.619280 => 02:19:29.622238
[0m02:19:29.623121 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m02:19:29.649166 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m02:19:29.649999 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.650460 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m02:19:29.650896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:29.660005 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.660541 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.661006 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m02:19:29.661744 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.665745 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.666219 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint" rename to "stg_footprint__dbt_backup"
[0m02:19:29.666864 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.670473 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.671009 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m02:19:29.671653 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.673741 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:19:29.674193 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.674627 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:19:29.675719 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.679278 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:19:29.679838 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m02:19:29.681232 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.683014 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 02:19:29.623462 => 02:19:29.682718
[0m02:19:29.683518 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m02:19:29.687414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111888d0>]}
[0m02:19:29.688209 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.07s]
[0m02:19:29.689110 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m02:19:29.689873 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m02:19:29.690468 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m02:19:29.691255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m02:19:29.691696 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m02:19:29.695069 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.696065 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 02:19:29.691998 => 02:19:29.695757
[0m02:19:29.696534 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m02:19:29.702573 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.703439 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.703898 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m02:19:29.704326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:29.713538 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.714104 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.714574 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m02:19:29.715316 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.719350 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.719918 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m02:19:29.720658 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.724513 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.725012 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:19:29.725697 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.727734 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:19:29.728180 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.728610 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:19:29.729654 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.732969 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:19:29.733440 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m02:19:29.734397 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.736085 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 02:19:29.696828 => 02:19:29.735804
[0m02:19:29.736565 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m02:19:29.740369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114df650>]}
[0m02:19:29.741149 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m02:19:29.742033 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m02:19:29.742657 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m02:19:29.743227 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m02:19:29.744079 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m02:19:29.744576 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m02:19:29.748357 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m02:19:29.749669 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 02:19:29.744910 => 02:19:29.749278
[0m02:19:29.750198 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m02:19:29.756291 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m02:19:29.757155 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.757682 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m02:19:29.758183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:29.768228 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.768801 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.769301 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m02:19:29.774323 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.778115 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.778583 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends" rename to "country_trends__dbt_backup"
[0m02:19:29.779254 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.782878 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.783342 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m02:19:29.784018 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.786452 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:19:29.786933 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.787430 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:19:29.790018 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.794472 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:19:29.795785 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m02:19:29.797294 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:29.799565 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 02:19:29.750556 => 02:19:29.799178
[0m02:19:29.800165 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m02:19:29.808833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '630cbd17-97cb-4e41-9f2c-7e6012516549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f5f50>]}
[0m02:19:29.809741 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.06s]
[0m02:19:29.810763 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m02:19:29.906387 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:29.907311 [debug] [MainThread]: On master: BEGIN
[0m02:19:29.908173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:29.920195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:29.920768 [debug] [MainThread]: On master: COMMIT
[0m02:19:29.921224 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:29.921672 [debug] [MainThread]: On master: COMMIT
[0m02:19:29.922272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:29.922745 [debug] [MainThread]: On master: Close
[0m02:19:29.924948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:29.925406 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m02:19:29.925885 [info ] [MainThread]: 
[0m02:19:29.926462 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:19:29.928543 [debug] [MainThread]: Command end result
[0m02:19:29.938138 [info ] [MainThread]: 
[0m02:19:29.938744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:19:29.939272 [info ] [MainThread]: 
[0m02:19:29.939830 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:19:29.940582 [debug] [MainThread]: Command `dbt run` succeeded at 02:19:29.940421 after 0.89 seconds
[0m02:19:29.941055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141a710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126c0d0>]}
[0m02:19:29.941525 [debug] [MainThread]: Flushing usage events
[0m02:19:32.942526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcdb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcde90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcdf50>]}


============================== 02:19:32.945993 | 1be2442e-fb53-4148-b884-0f0581217080 ==============================
[0m02:19:32.945993 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:19:32.946843 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'warn_error': 'None'}
[0m02:19:33.071276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111037e50>]}
[0m02:19:33.090764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe3050>]}
[0m02:19:33.091422 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:19:33.104220 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:19:33.133969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:19:33.134383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:19:33.141675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c0d50>]}
[0m02:19:33.148999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111151c10>]}
[0m02:19:33.149516 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:19:33.149956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111151c10>]}
[0m02:19:33.151625 [info ] [MainThread]: 
[0m02:19:33.152578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:19:33.153950 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint_main'
[0m02:19:33.219396 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:19:33.220038 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:19:33.220533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:33.236528 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:33.237166 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:19:33.237657 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:19:33.250851 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:19:33.252721 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:19:33.253476 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:19:33.253895 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:19:33.257869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be2442e-fb53-4148-b884-0f0581217080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111079d90>]}
[0m02:19:33.258462 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:33.258890 [debug] [MainThread]: On master: BEGIN
[0m02:19:33.259300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:33.269751 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:33.270245 [debug] [MainThread]: On master: COMMIT
[0m02:19:33.270665 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:33.271067 [debug] [MainThread]: On master: COMMIT
[0m02:19:33.271605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:33.272026 [debug] [MainThread]: On master: Close
[0m02:19:33.273955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:33.274468 [info ] [MainThread]: 
[0m02:19:33.276454 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:19:33.277028 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m02:19:33.277924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m02:19:33.278435 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:19:33.305337 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:19:33.306534 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 02:19:33.278782 => 02:19:33.306175
[0m02:19:33.307102 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:19:33.327453 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:19:33.328377 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:19:33.328901 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m02:19:33.329397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:33.338712 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.339333 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m02:19:33.339797 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m02:19:33.341105 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.343843 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 02:19:33.307456 => 02:19:33.343553
[0m02:19:33.344320 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m02:19:33.344869 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m02:19:33.345293 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m02:19:33.347315 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
[0m02:19:33.348173 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m02:19:33.348775 [debug] [Thread-1  ]: Began running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:19:33.349327 [info ] [Thread-1  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m02:19:33.350108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m02:19:33.350532 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:19:33.355827 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:19:33.356795 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 02:19:33.350821 => 02:19:33.356490
[0m02:19:33.357281 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:19:33.360606 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:19:33.361558 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:19:33.362076 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m02:19:33.362564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:33.373324 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.374120 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m02:19:33.374732 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "footprint"."main"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m02:19:33.376259 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.378595 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 02:19:33.357601 => 02:19:33.378120
[0m02:19:33.379590 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m02:19:33.380725 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m02:19:33.381481 [debug] [Thread-1  ]: On test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m02:19:33.384300 [info ] [Thread-1  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
[0m02:19:33.385407 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m02:19:33.386310 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:19:33.387254 [info ] [Thread-1  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m02:19:33.388783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m02:19:33.389519 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:19:33.399557 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:19:33.400658 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 02:19:33.389911 => 02:19:33.400298
[0m02:19:33.401289 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:19:33.405333 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:19:33.407795 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:19:33.408691 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m02:19:33.409586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:33.421624 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.422348 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m02:19:33.422935 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:19:33.424446 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.426541 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 02:19:33.401666 => 02:19:33.426202
[0m02:19:33.427104 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m02:19:33.427706 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m02:19:33.428217 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m02:19:33.431153 [info ] [Thread-1  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
[0m02:19:33.432408 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321
[0m02:19:33.433164 [debug] [Thread-1  ]: Began running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:19:33.434147 [info ] [Thread-1  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m02:19:33.436861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.footprint_dbt.unique_my_first_dbt_model_id.16e066b321, now test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m02:19:33.437759 [debug] [Thread-1  ]: Began compiling node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:19:33.445999 [debug] [Thread-1  ]: Writing injected SQL for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:19:33.447328 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 02:19:33.438383 => 02:19:33.446944
[0m02:19:33.447937 [debug] [Thread-1  ]: Began executing node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:19:33.451897 [debug] [Thread-1  ]: Writing runtime sql for node "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:19:33.453103 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:19:33.453712 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m02:19:33.454346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:19:33.466413 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.467243 [debug] [Thread-1  ]: Using duckdb connection "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m02:19:33.468183 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "footprint"."main"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:19:33.470311 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:19:33.472783 [debug] [Thread-1  ]: Timing info for test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 02:19:33.448320 => 02:19:33.472376
[0m02:19:33.473475 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m02:19:33.474167 [debug] [Thread-1  ]: Failed to rollback 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m02:19:33.474734 [debug] [Thread-1  ]: On test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m02:19:33.477372 [info ] [Thread-1  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
[0m02:19:33.478524 [debug] [Thread-1  ]: Finished running node test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m02:19:33.481976 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:33.482784 [debug] [MainThread]: On master: BEGIN
[0m02:19:33.483788 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:33.495958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:33.496552 [debug] [MainThread]: On master: COMMIT
[0m02:19:33.497019 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:33.497476 [debug] [MainThread]: On master: COMMIT
[0m02:19:33.498070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:19:33.498546 [debug] [MainThread]: On master: Close
[0m02:19:33.500725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:33.501185 [debug] [MainThread]: Connection 'test.footprint_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m02:19:33.501679 [info ] [MainThread]: 
[0m02:19:33.502265 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:19:33.504354 [debug] [MainThread]: Command end result
[0m02:19:33.514074 [info ] [MainThread]: 
[0m02:19:33.514769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:19:33.515291 [info ] [MainThread]: 
[0m02:19:33.515834 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m02:19:33.516328 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:19:33.516812 [info ] [MainThread]: 
[0m02:19:33.517299 [info ] [MainThread]:   compiled Code at target/compiled/footprint_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m02:19:33.517854 [info ] [MainThread]: 
[0m02:19:33.518415 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m02:19:33.519173 [debug] [MainThread]: Command `dbt test` failed at 02:19:33.519011 after 0.60 seconds
[0m02:19:33.519667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f0bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111108650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11118ee90>]}
[0m02:19:33.520148 [debug] [MainThread]: Flushing usage events
[0m02:20:14.086600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffdb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ffdf10>]}


============================== 02:20:14.090168 | 320ce886-5ea3-4dc9-b1f2-ff291674c117 ==============================
[0m02:20:14.090168 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:20:14.091024 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default'}
[0m02:20:14.216601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109068f50>]}
[0m02:20:14.236265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109033f10>]}
[0m02:20:14.236962 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:20:14.249854 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:20:14.280377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:20:14.280796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:20:14.287813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090752d0>]}
[0m02:20:14.295110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091816d0>]}
[0m02:20:14.295763 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:20:14.296207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109181dd0>]}
[0m02:20:14.297916 [info ] [MainThread]: 
[0m02:20:14.298828 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:20:14.300276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m02:20:14.366545 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m02:20:14.367377 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m02:20:14.368075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:14.386190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.388182 [debug] [ThreadPool]: On list_footprint: Close
[0m02:20:14.391170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m02:20:14.392218 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m02:20:14.399690 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:20:14.400147 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m02:20:14.400560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:14.410997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.411499 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:20:14.411923 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m02:20:14.412542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.413705 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:20:14.414136 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:20:14.414539 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:20:14.415239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.415689 [debug] [ThreadPool]: On create_footprint_main: Close
[0m02:20:14.419165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m02:20:14.427768 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:20:14.428209 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:20:14.428598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:20:14.438223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.438699 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:20:14.439126 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:20:14.450522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:20:14.452080 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:20:14.452708 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:20:14.453054 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:20:14.456393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918bd90>]}
[0m02:20:14.456915 [debug] [MainThread]: Using duckdb connection "master"
[0m02:20:14.457280 [debug] [MainThread]: On master: BEGIN
[0m02:20:14.457644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:20:14.466107 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:20:14.466531 [debug] [MainThread]: On master: COMMIT
[0m02:20:14.466934 [debug] [MainThread]: Using duckdb connection "master"
[0m02:20:14.467283 [debug] [MainThread]: On master: COMMIT
[0m02:20:14.467737 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:20:14.468100 [debug] [MainThread]: On master: Close
[0m02:20:14.469877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:14.470334 [info ] [MainThread]: 
[0m02:20:14.472064 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m02:20:14.472659 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m02:20:14.473461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m02:20:14.473910 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m02:20:14.483577 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.484455 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 02:20:14.474215 => 02:20:14.484156
[0m02:20:14.484924 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m02:20:14.535341 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.536379 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.536903 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m02:20:14.537396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:14.547991 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.548592 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.549137 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m02:20:14.550453 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.559327 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.559877 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m02:20:14.560650 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.565331 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.565820 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:20:14.566459 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.593282 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:20:14.593791 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.594236 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:20:14.595639 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.602681 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:20:14.603172 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m02:20:14.604215 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.605973 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 02:20:14.485220 => 02:20:14.605687
[0m02:20:14.606459 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m02:20:14.610721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109331550>]}
[0m02:20:14.611517 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m02:20:14.612395 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m02:20:14.612986 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m02:20:14.613529 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m02:20:14.614315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m02:20:14.614752 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m02:20:14.617046 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m02:20:14.618013 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 02:20:14.615052 => 02:20:14.617716
[0m02:20:14.618472 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m02:20:14.643844 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m02:20:14.644690 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.645152 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m02:20:14.645585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:14.653958 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.654469 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.655009 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m02:20:14.655760 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.659666 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.660126 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint" rename to "stg_footprint__dbt_backup"
[0m02:20:14.660794 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.664346 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.664800 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m02:20:14.665408 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.667493 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:20:14.667987 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.668415 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:20:14.669469 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.672767 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:20:14.673238 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m02:20:14.674189 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.675881 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 02:20:14.618766 => 02:20:14.675606
[0m02:20:14.676355 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m02:20:14.680337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093071d0>]}
[0m02:20:14.681114 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.07s]
[0m02:20:14.681971 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m02:20:14.682698 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m02:20:14.683243 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m02:20:14.684033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m02:20:14.684473 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m02:20:14.687801 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.688885 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 02:20:14.684777 => 02:20:14.688586
[0m02:20:14.689347 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m02:20:14.695260 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.696015 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.696468 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m02:20:14.696897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:14.711534 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.712071 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.712532 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m02:20:14.713274 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.717255 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.717801 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m02:20:14.718438 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.721996 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.722497 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:20:14.723127 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.725113 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:20:14.725559 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.725985 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:20:14.727032 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.730273 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:20:14.730739 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m02:20:14.731678 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.733379 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 02:20:14.689641 => 02:20:14.733037
[0m02:20:14.733866 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m02:20:14.737829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bf550>]}
[0m02:20:14.738605 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m02:20:14.739449 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m02:20:14.740025 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m02:20:14.740555 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m02:20:14.741325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m02:20:14.741757 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m02:20:14.745084 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m02:20:14.745936 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 02:20:14.742051 => 02:20:14.745653
[0m02:20:14.746393 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m02:20:14.751049 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m02:20:14.751790 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.752244 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m02:20:14.752667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:20:14.761561 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.762074 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.762544 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m02:20:14.767261 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.771133 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.771649 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends" rename to "country_trends__dbt_backup"
[0m02:20:14.772344 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.775910 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.776368 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m02:20:14.777032 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.779333 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:20:14.779781 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.780208 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:20:14.781789 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.785286 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:20:14.785794 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m02:20:14.786886 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:20:14.788609 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 02:20:14.746682 => 02:20:14.788336
[0m02:20:14.789086 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m02:20:14.796733 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '320ce886-5ea3-4dc9-b1f2-ff291674c117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109311950>]}
[0m02:20:14.797505 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.06s]
[0m02:20:14.798351 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m02:20:14.898137 [debug] [MainThread]: Using duckdb connection "master"
[0m02:20:14.899094 [debug] [MainThread]: On master: BEGIN
[0m02:20:14.899869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:20:14.912336 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:20:14.912930 [debug] [MainThread]: On master: COMMIT
[0m02:20:14.913396 [debug] [MainThread]: Using duckdb connection "master"
[0m02:20:14.913855 [debug] [MainThread]: On master: COMMIT
[0m02:20:14.914448 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:20:14.914922 [debug] [MainThread]: On master: Close
[0m02:20:14.917051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:14.917495 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m02:20:14.918004 [info ] [MainThread]: 
[0m02:20:14.918576 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:20:14.920686 [debug] [MainThread]: Command end result
[0m02:20:14.930304 [info ] [MainThread]: 
[0m02:20:14.930904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:14.931396 [info ] [MainThread]: 
[0m02:20:14.931954 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:20:14.932704 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:14.932547 after 0.87 seconds
[0m02:20:14.933174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109201050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109367150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109332410>]}
[0m02:20:14.933686 [debug] [MainThread]: Flushing usage events
[0m02:23:28.730604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99eed0>]}


============================== 02:23:28.734078 | 067b49ea-60a4-4434-a79b-5c4e49122bdd ==============================
[0m02:23:28.734078 [info ] [MainThread]: Running with dbt=1.5.11
[0m02:23:28.734935 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt'}
[0m02:23:28.857703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea09e90>]}
[0m02:23:28.876920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea75910>]}
[0m02:23:28.877617 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m02:23:28.890350 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m02:23:28.920923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:23:28.921348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:23:28.928625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99e450>]}
[0m02:23:28.935878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb23690>]}
[0m02:23:28.936383 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m02:23:28.936821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb23690>]}
[0m02:23:28.938458 [info ] [MainThread]: 
[0m02:23:28.939444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:23:28.940988 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m02:23:29.009142 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m02:23:29.009769 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m02:23:29.010312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:29.027428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.029367 [debug] [ThreadPool]: On list_footprint: Close
[0m02:23:29.032324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m02:23:29.033378 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m02:23:29.040817 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:23:29.041279 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m02:23:29.041686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:29.052129 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.052624 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:23:29.053048 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m02:23:29.053666 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.054817 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:23:29.055243 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m02:23:29.055643 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m02:23:29.056208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.056675 [debug] [ThreadPool]: On create_footprint_main: Close
[0m02:23:29.060041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m02:23:29.068632 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:23:29.069063 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m02:23:29.069448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:29.079304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.079844 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m02:23:29.080293 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m02:23:29.095059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m02:23:29.096808 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m02:23:29.097540 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m02:23:29.097950 [debug] [ThreadPool]: On list_footprint_main: Close
[0m02:23:29.100759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2dc410>]}
[0m02:23:29.101358 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:29.101778 [debug] [MainThread]: On master: BEGIN
[0m02:23:29.102176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:29.112712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:29.128431 [debug] [MainThread]: On master: COMMIT
[0m02:23:29.129528 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:29.149723 [debug] [MainThread]: On master: COMMIT
[0m02:23:29.170241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:29.171253 [debug] [MainThread]: On master: Close
[0m02:23:29.175374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:23:29.193842 [info ] [MainThread]: 
[0m02:23:29.197415 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m02:23:29.198531 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m02:23:29.200237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m02:23:29.200969 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m02:23:29.213775 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.214944 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 02:23:29.201394 => 02:23:29.214548
[0m02:23:29.215555 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m02:23:29.267954 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.268874 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.269336 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m02:23:29.269772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:23:29.278569 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.279095 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.279573 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m02:23:29.280604 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.288543 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.289117 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m02:23:29.289827 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.313648 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:23:29.314141 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.314576 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m02:23:29.316227 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.324512 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m02:23:29.324994 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m02:23:29.325886 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.327545 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 02:23:29.215936 => 02:23:29.327275
[0m02:23:29.328013 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m02:23:29.331990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb5190>]}
[0m02:23:29.332909 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.13s]
[0m02:23:29.333843 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m02:23:29.334494 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m02:23:29.335100 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m02:23:29.336007 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m02:23:29.336510 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m02:23:29.339090 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m02:23:29.340148 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 02:23:29.336856 => 02:23:29.339809
[0m02:23:29.340683 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m02:23:29.366682 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m02:23:29.367514 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:23:29.367952 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m02:23:29.368370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:23:29.376675 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.377182 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:23:29.377628 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m02:23:29.378482 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.382319 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:23:29.382791 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m02:23:29.383474 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.385423 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:23:29.385898 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:23:29.386331 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m02:23:29.387594 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.391078 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m02:23:29.391587 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m02:23:29.392279 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.394231 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 02:23:29.341021 => 02:23:29.393914
[0m02:23:29.394806 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m02:23:29.398740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecd7c50>]}
[0m02:23:29.399783 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.06s]
[0m02:23:29.401018 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m02:23:29.401726 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m02:23:29.402387 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m02:23:29.403640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m02:23:29.404404 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m02:23:29.409217 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.410517 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 02:23:29.404931 => 02:23:29.410088
[0m02:23:29.411325 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m02:23:29.417752 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.418788 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.419332 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m02:23:29.419842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:23:29.430393 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.431012 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.431554 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m02:23:29.432385 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.436957 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.437513 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m02:23:29.438260 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.440343 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:23:29.440865 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.441363 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m02:23:29.442541 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.447359 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m02:23:29.447913 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m02:23:29.448647 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.450527 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 02:23:29.411831 => 02:23:29.450212
[0m02:23:29.451077 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m02:23:29.455064 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed325d0>]}
[0m02:23:29.455987 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m02:23:29.456995 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m02:23:29.457759 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m02:23:29.458410 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m02:23:29.459313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m02:23:29.459816 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m02:23:29.463697 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m02:23:29.464703 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 02:23:29.460159 => 02:23:29.464372
[0m02:23:29.465235 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m02:23:29.470464 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m02:23:29.471308 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:23:29.471821 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m02:23:29.472314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:23:29.482038 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.482663 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:23:29.483213 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m02:23:29.488455 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.492970 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:23:29.493512 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m02:23:29.494278 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.496686 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:23:29.497216 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:23:29.497717 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m02:23:29.499262 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.502971 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m02:23:29.503592 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m02:23:29.504295 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m02:23:29.506172 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 02:23:29.465572 => 02:23:29.505856
[0m02:23:29.506717 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m02:23:29.513601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067b49ea-60a4-4434-a79b-5c4e49122bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed9c1d0>]}
[0m02:23:29.514449 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.05s]
[0m02:23:29.515459 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m02:23:29.516736 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:29.517155 [debug] [MainThread]: On master: BEGIN
[0m02:23:29.517541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:29.527041 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:29.527530 [debug] [MainThread]: On master: COMMIT
[0m02:23:29.527938 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:29.528332 [debug] [MainThread]: On master: COMMIT
[0m02:23:29.528874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m02:23:29.529335 [debug] [MainThread]: On master: Close
[0m02:23:29.531287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:29.531680 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m02:23:29.532116 [info ] [MainThread]: 
[0m02:23:29.532631 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m02:23:29.534487 [debug] [MainThread]: Command end result
[0m02:23:29.542532 [info ] [MainThread]: 
[0m02:23:29.543078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:23:29.543563 [info ] [MainThread]: 
[0m02:23:29.544104 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m02:23:29.544836 [debug] [MainThread]: Command `dbt run` succeeded at 02:23:29.544688 after 0.84 seconds
[0m02:23:29.545280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9c0450>]}
[0m02:23:29.545731 [debug] [MainThread]: Flushing usage events
[0m07:38:27.436363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc77bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc77f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc77f10>]}


============================== 07:38:27.440895 | 3168899d-5414-4959-a3d0-e1d91b614bf8 ==============================
[0m07:38:27.440895 [info ] [MainThread]: Running with dbt=1.5.11
[0m07:38:27.441783 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt/logs', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/Users/radhin/Downloads/footprint-data-pipeline/footprint_dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m07:38:27.582984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce2f10>]}
[0m07:38:27.605233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc997d0>]}
[0m07:38:27.606365 [info ] [MainThread]: Registered adapter: duckdb=1.5.2
[0m07:38:27.621037 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m07:38:27.677631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:38:27.678211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:38:27.686539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd53fd0>]}
[0m07:38:27.696154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdfd390>]}
[0m07:38:27.696809 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m07:38:27.697333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdfd690>]}
[0m07:38:27.699281 [info ] [MainThread]: 
[0m07:38:27.700271 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:38:27.701781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_footprint'
[0m07:38:27.762909 [debug] [ThreadPool]: Using duckdb connection "list_footprint"
[0m07:38:27.763493 [debug] [ThreadPool]: On list_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"footprint"'
    
  
  
[0m07:38:27.763955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:27.781985 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.784173 [debug] [ThreadPool]: On list_footprint: Close
[0m07:38:27.786868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_footprint, now create_footprint_main)
[0m07:38:27.787836 [debug] [ThreadPool]: Creating schema "database: "footprint"
schema: "main"
"
[0m07:38:27.794874 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m07:38:27.795373 [debug] [ThreadPool]: On create_footprint_main: BEGIN
[0m07:38:27.795780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:27.806681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.807203 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m07:38:27.807627 [debug] [ThreadPool]: On create_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "create_footprint_main"} */
create schema if not exists "footprint"."main"
[0m07:38:27.808269 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.809409 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m07:38:27.809841 [debug] [ThreadPool]: Using duckdb connection "create_footprint_main"
[0m07:38:27.810240 [debug] [ThreadPool]: On create_footprint_main: COMMIT
[0m07:38:27.810791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.811213 [debug] [ThreadPool]: On create_footprint_main: Close
[0m07:38:27.814808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_footprint_main, now list_footprint_main)
[0m07:38:27.823594 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m07:38:27.824100 [debug] [ThreadPool]: On list_footprint_main: BEGIN
[0m07:38:27.824498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:27.834805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.835307 [debug] [ThreadPool]: Using duckdb connection "list_footprint_main"
[0m07:38:27.835706 [debug] [ThreadPool]: On list_footprint_main: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "connection_name": "list_footprint_main"} */
select
      'footprint' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    
    and table_catalog = 'footprint'
    
  
[0m07:38:27.851149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m07:38:27.852966 [debug] [ThreadPool]: On list_footprint_main: ROLLBACK
[0m07:38:27.854802 [debug] [ThreadPool]: Failed to rollback 'list_footprint_main'
[0m07:38:27.855250 [debug] [ThreadPool]: On list_footprint_main: Close
[0m07:38:27.859334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbf110>]}
[0m07:38:27.859948 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:27.860374 [debug] [MainThread]: On master: BEGIN
[0m07:38:27.860768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:27.870422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:38:27.870894 [debug] [MainThread]: On master: COMMIT
[0m07:38:27.871266 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:27.871615 [debug] [MainThread]: On master: COMMIT
[0m07:38:27.872092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:38:27.872468 [debug] [MainThread]: On master: Close
[0m07:38:27.874407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:38:27.874912 [info ] [MainThread]: 
[0m07:38:27.877187 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_first_dbt_model
[0m07:38:27.877822 [info ] [Thread-1  ]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m07:38:27.878664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_footprint_main, now model.footprint_dbt.my_first_dbt_model)
[0m07:38:27.879140 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_first_dbt_model
[0m07:38:27.889055 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.890062 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (compile): 07:38:27.879454 => 07:38:27.889739
[0m07:38:27.890566 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_first_dbt_model
[0m07:38:27.943726 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.944750 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.945288 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: BEGIN
[0m07:38:27.945793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:38:27.955724 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:27.956354 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.956916 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "footprint"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m07:38:27.958620 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:27.967833 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.968446 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m07:38:27.969364 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:27.974511 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:27.975120 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
alter table "footprint"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m07:38:27.975937 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.004646 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m07:38:28.005218 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:28.005679 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: COMMIT
[0m07:38:28.006831 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.014202 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_first_dbt_model"
[0m07:38:28.014747 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_first_dbt_model"} */
drop table if exists "footprint"."main"."my_first_dbt_model__dbt_backup" cascade
[0m07:38:28.015789 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.017670 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_first_dbt_model (execute): 07:38:27.890868 => 07:38:28.017375
[0m07:38:28.018185 [debug] [Thread-1  ]: On model.footprint_dbt.my_first_dbt_model: Close
[0m07:38:28.022149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf9ba10>]}
[0m07:38:28.022947 [info ] [Thread-1  ]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.14s]
[0m07:38:28.023836 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_first_dbt_model
[0m07:38:28.024431 [debug] [Thread-1  ]: Began running node model.footprint_dbt.stg_footprint
[0m07:38:28.025114 [info ] [Thread-1  ]: 2 of 4 START sql view model main.stg_footprint ................................. [RUN]
[0m07:38:28.026001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_first_dbt_model, now model.footprint_dbt.stg_footprint)
[0m07:38:28.026453 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.stg_footprint
[0m07:38:28.028882 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.stg_footprint"
[0m07:38:28.030506 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (compile): 07:38:28.026760 => 07:38:28.030137
[0m07:38:28.031036 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.stg_footprint
[0m07:38:28.061493 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.stg_footprint"
[0m07:38:28.062517 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.063063 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: BEGIN
[0m07:38:28.063566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:38:28.074186 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.074821 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.075370 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */

  
  create view "footprint"."main"."stg_footprint__dbt_tmp" as (
    SELECT
    country,
    year,
    carbon_footprint,
    ingestion_date
FROM raw_footprint
WHERE carbon_footprint IS NOT NULL
  );

[0m07:38:28.076358 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.080936 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.081525 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint" rename to "stg_footprint__dbt_backup"
[0m07:38:28.082773 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.087166 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.087762 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
alter view "footprint"."main"."stg_footprint__dbt_tmp" rename to "stg_footprint"
[0m07:38:28.088632 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.091138 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m07:38:28.091711 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.092237 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: COMMIT
[0m07:38:28.093457 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.097474 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.stg_footprint"
[0m07:38:28.098078 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.stg_footprint"} */
drop view if exists "footprint"."main"."stg_footprint__dbt_backup" cascade
[0m07:38:28.099173 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.101209 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.stg_footprint (execute): 07:38:28.031344 => 07:38:28.100886
[0m07:38:28.101778 [debug] [Thread-1  ]: On model.footprint_dbt.stg_footprint: Close
[0m07:38:28.105904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd3b890>]}
[0m07:38:28.106800 [info ] [Thread-1  ]: 2 of 4 OK created sql view model main.stg_footprint ............................ [[32mOK[0m in 0.08s]
[0m07:38:28.107804 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.stg_footprint
[0m07:38:28.108685 [debug] [Thread-1  ]: Began running node model.footprint_dbt.my_second_dbt_model
[0m07:38:28.109354 [info ] [Thread-1  ]: 3 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m07:38:28.110508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.stg_footprint, now model.footprint_dbt.my_second_dbt_model)
[0m07:38:28.111064 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.my_second_dbt_model
[0m07:38:28.115080 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.116115 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (compile): 07:38:28.111421 => 07:38:28.115763
[0m07:38:28.116665 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.my_second_dbt_model
[0m07:38:28.123824 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.124766 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.125299 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: BEGIN
[0m07:38:28.125808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:38:28.135468 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.136170 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.136721 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */

  
  create view "footprint"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "footprint"."main"."my_first_dbt_model"
where id = 1
  );

[0m07:38:28.137552 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.142114 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.142681 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m07:38:28.143590 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.147893 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.148456 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
alter view "footprint"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m07:38:28.149231 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.151630 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m07:38:28.152178 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.152681 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: COMMIT
[0m07:38:28.153873 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.157814 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.my_second_dbt_model"
[0m07:38:28.158387 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.my_second_dbt_model"} */
drop view if exists "footprint"."main"."my_second_dbt_model__dbt_backup" cascade
[0m07:38:28.159426 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.161442 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.my_second_dbt_model (execute): 07:38:28.117005 => 07:38:28.161120
[0m07:38:28.162007 [debug] [Thread-1  ]: On model.footprint_dbt.my_second_dbt_model: Close
[0m07:38:28.166023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d052710>]}
[0m07:38:28.166893 [info ] [Thread-1  ]: 3 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m07:38:28.167892 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.my_second_dbt_model
[0m07:38:28.168563 [debug] [Thread-1  ]: Began running node model.footprint_dbt.country_trends
[0m07:38:28.169191 [info ] [Thread-1  ]: 4 of 4 START sql table model main.country_trends ............................... [RUN]
[0m07:38:28.170152 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.footprint_dbt.my_second_dbt_model, now model.footprint_dbt.country_trends)
[0m07:38:28.170657 [debug] [Thread-1  ]: Began compiling node model.footprint_dbt.country_trends
[0m07:38:28.174555 [debug] [Thread-1  ]: Writing injected SQL for node "model.footprint_dbt.country_trends"
[0m07:38:28.176029 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (compile): 07:38:28.171001 => 07:38:28.175660
[0m07:38:28.176596 [debug] [Thread-1  ]: Began executing node model.footprint_dbt.country_trends
[0m07:38:28.182127 [debug] [Thread-1  ]: Writing runtime sql for node "model.footprint_dbt.country_trends"
[0m07:38:28.183037 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.183566 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: BEGIN
[0m07:38:28.184059 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:38:28.193556 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.194129 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.194608 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */

  
    
    

    create  table
      "footprint"."main"."country_trends__dbt_tmp"
  
    as (
      SELECT
    country,
    year,
    carbon_footprint,
    AVG(carbon_footprint)
      OVER (
        PARTITION BY country
        ORDER BY year
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
      ) AS rolling_3y_avg
FROM "footprint"."main"."stg_footprint"
    );
  
  
[0m07:38:28.201562 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.205371 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.205873 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends" rename to "country_trends__dbt_backup"
[0m07:38:28.206579 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.210349 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.210866 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
alter table "footprint"."main"."country_trends__dbt_tmp" rename to "country_trends"
[0m07:38:28.211587 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.214107 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m07:38:28.214628 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.215079 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: COMMIT
[0m07:38:28.216464 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.220080 [debug] [Thread-1  ]: Using duckdb connection "model.footprint_dbt.country_trends"
[0m07:38:28.220627 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "footprint", "target_name": "dev", "node_id": "model.footprint_dbt.country_trends"} */
drop table if exists "footprint"."main"."country_trends__dbt_backup" cascade
[0m07:38:28.221796 [debug] [Thread-1  ]: SQL status: OK in 0.0 seconds
[0m07:38:28.223651 [debug] [Thread-1  ]: Timing info for model.footprint_dbt.country_trends (execute): 07:38:28.176996 => 07:38:28.223364
[0m07:38:28.224182 [debug] [Thread-1  ]: On model.footprint_dbt.country_trends: Close
[0m07:38:28.231266 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3168899d-5414-4959-a3d0-e1d91b614bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd93d90>]}
[0m07:38:28.232174 [info ] [Thread-1  ]: 4 of 4 OK created sql table model main.country_trends .......................... [[32mOK[0m in 0.06s]
[0m07:38:28.233217 [debug] [Thread-1  ]: Finished running node model.footprint_dbt.country_trends
[0m07:38:28.296487 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:28.297026 [debug] [MainThread]: On master: BEGIN
[0m07:38:28.297449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:28.307160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:38:28.307680 [debug] [MainThread]: On master: COMMIT
[0m07:38:28.308141 [debug] [MainThread]: Using duckdb connection "master"
[0m07:38:28.308527 [debug] [MainThread]: On master: COMMIT
[0m07:38:28.309068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m07:38:28.309471 [debug] [MainThread]: On master: Close
[0m07:38:28.311433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:28.311805 [debug] [MainThread]: Connection 'model.footprint_dbt.country_trends' was properly closed.
[0m07:38:28.312227 [info ] [MainThread]: 
[0m07:38:28.312708 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m07:38:28.314414 [debug] [MainThread]: Command end result
[0m07:38:28.323638 [info ] [MainThread]: 
[0m07:38:28.324282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:38:28.324775 [info ] [MainThread]: 
[0m07:38:28.325335 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:38:28.326098 [debug] [MainThread]: Command `dbt run` succeeded at 07:38:28.325938 after 0.95 seconds
[0m07:38:28.326575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7f9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce06290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf9bad0>]}
[0m07:38:28.327061 [debug] [MainThread]: Flushing usage events
